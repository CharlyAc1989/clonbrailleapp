/* ================================
   BRAILLE QUEST - Main Styles
   ================================ */

@import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap');

/* Material Symbols */
.material-symbols-outlined {
    font-family: 'Material Symbols Outlined';
    font-weight: normal;
    font-style: normal;
    font-size: 24px;
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    font-feature-settings: 'liga';
}

/* CSS Custom Properties (Design Tokens) */
:root {
    /* Colors - Vibrant Modern Palette */
    --color-bg-primary: #F5F8FF;
    --color-bg-secondary: #FFFFFF;
    --color-bg-card: #FFFFFF;
    --color-bg-elevated: #EDF2FF;

    --color-text-primary: #1E2A4A;
    --color-text-secondary: #4A5578;
    --color-text-muted: #7A82A6;

    /* Primary: Rich Ocean Blue */
    --color-accent-primary: #3B82F6;
    /* Secondary: Vibrant Coral */
    --color-accent-secondary: #F97066;
    /* Tertiary: Fresh Emerald */
    --color-accent-tertiary: #10B981;
    /* Quaternary: Warm Amber */
    --color-accent-quaternary: #F59E0B;
    /* Bonus: Playful Purple */
    --color-accent-purple: #8B5CF6;

    --color-success: #10B981;
    --color-warning: #F59E0B;
    --color-error: #EF4444;

    /* Braille Dots - More vibrant */
    --color-dot-raised: #3B82F6;
    --color-dot-unraised: #E2E8F0;
    --color-dot-border: #CBD5E1;

    /* Gradients - More Dynamic */
    --gradient-primary: linear-gradient(135deg, #3B82F6 0%, #60A5FA 100%);
    --gradient-success: linear-gradient(135deg, #10B981 0%, #34D399 100%);
    --gradient-warning: linear-gradient(135deg, #F59E0B 0%, #FBBF24 100%);
    --gradient-card: linear-gradient(145deg, #FFFFFF 0%, #F8FAFF 100%);
    --gradient-purple: linear-gradient(135deg, #8B5CF6 0%, #A78BFA 100%);
    --gradient-coral: linear-gradient(135deg, #F97066 0%, #FB923C 100%);

    /* Shadows - Softer with color tints */
    --shadow-sm: 0 2px 8px rgba(59, 130, 246, 0.08);
    --shadow-md: 0 4px 16px rgba(59, 130, 246, 0.12);
    --shadow-lg: 0 8px 32px rgba(59, 130, 246, 0.16);
    --shadow-glow: 0 0 24px rgba(59, 130, 246, 0.25);
    --shadow-glow-success: 0 0 24px rgba(16, 185, 129, 0.25);

    /* Typography */
    --font-family: 'Quicksand', 'Inter', -apple-system, sans-serif;
    --font-size-xs: 0.9375rem;
    /* 15px */
    --font-size-sm: 1.0625rem;
    /* 17px */
    --font-size-base: 1.125rem;
    /* 18px */
    --font-size-lg: 1.1875rem;
    --font-size-xl: 1.375rem;
    --font-size-2xl: 1.75rem;
    --font-size-3xl: 2.25rem;
    --font-size-4xl: 3rem;
    --font-size-5xl: 4rem;

    /* Spacing */
    --space-xs: 0.5rem;
    --space-sm: 0.75rem;
    --space-md: 1.25rem;
    --space-lg: 1.75rem;
    --space-xl: 2.5rem;
    --space-2xl: 3.5rem;
    --space-3xl: 5rem;

    /* Border Radius - Very Rounded */
    --radius-sm: 1rem;
    --radius-md: 1.5rem;
    --radius-lg: 2rem;
    --radius-xl: 2.5rem;
    --radius-full: 9999px;

    /* Transitions */
    --transition-fast: 100ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-base: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);

    /* Touch Targets */
    --touch-min: 52px;
}

/* High Contrast Mode - WCAG AAA Compliant */
.high-contrast {
    /* Pure black background for maximum contrast */
    --color-bg-primary: #000000;
    --color-bg-secondary: #0D0D0D;
    --color-bg-card: #141414;
    --color-bg-elevated: #1C1C1C;

    /* Pure white text for maximum readability */
    --color-text-primary: #FFFFFF;
    --color-text-secondary: #F5F5F5;
    --color-text-muted: #CCCCCC;

    /* High-visibility accent colors (WCAG AAA on black) */
    --color-accent-primary: #00D4FF;
    /* Bright Cyan - 7.2:1 contrast */
    --color-accent-secondary: #FF6B9D;
    /* Hot Pink - 5.8:1 contrast */
    --color-accent-tertiary: #00FF88;
    /* Neon Green - 8.5:1 contrast */
    --color-accent-quaternary: #FFD93D;
    /* Bright Yellow - 12.5:1 contrast */
    --color-accent-purple: #C084FC;
    /* Lavender - 6.1:1 contrast */

    --color-success: #00FF88;
    --color-warning: #FFD93D;
    --color-error: #FF5555;

    /* High-visibility Braille dots */
    --color-dot-raised: #FFD93D;
    /* Bright yellow for maximum visibility */
    --color-dot-unraised: #2A2A2A;
    --color-dot-border: #FFFFFF;

    /* Gradients for high contrast */
    --gradient-primary: linear-gradient(135deg, #00D4FF 0%, #00FF88 100%);
    --gradient-success: linear-gradient(135deg, #00FF88 0%, #00FFB3 100%);
    --gradient-warning: linear-gradient(135deg, #FFD93D 0%, #FFE680 100%);
    --gradient-card: linear-gradient(145deg, #141414 0%, #1C1C1C 100%);

    /* Stronger shadows with glow effect */
    --shadow-sm: 0 0 0 1px rgba(255, 255, 255, 0.2);
    --shadow-md: 0 0 0 2px rgba(255, 255, 255, 0.3);
    --shadow-lg: 0 0 16px rgba(0, 212, 255, 0.3);
    --shadow-glow: 0 0 32px rgba(0, 212, 255, 0.5);
}

/* Font Size Scaling */
.font-normal {
    font-size: 100%;
}

.font-large {
    font-size: 112.5%;
}

.font-extra-large {
    font-size: 125%;
}

/* ================================
   Reset & Base Styles
   ================================ */

*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    -webkit-text-size-adjust: 100%;
}

body {
    font-family: var(--font-family);
    background: var(--color-bg-primary);
    background-image:
        radial-gradient(circle at 10% 20%, rgba(71, 145, 255, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255, 107, 107, 0.05) 0%, transparent 20%);
    color: var(--color-text-primary);
    line-height: 1.6;
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Screen Reader Only */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Focus Styles */
:focus {
    outline: none;
}

:focus-visible {
    outline: 3px solid var(--color-accent-primary);
    outline-offset: 2px;
}

/* ================================
   App Container
   ================================ */

.app-container {
    max-width: 500px;
    margin: 0 auto;
    min-height: 100vh;
    min-height: 100dvh;
    position: relative;
    background: var(--color-bg-primary);
}

/* ================================
   Screen System
   ================================ */

.screen {
    display: none;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
    padding: var(--space-md);
    padding-bottom: calc(var(--space-md) + env(safe-area-inset-bottom));
    animation: fadeIn var(--transition-base);
}

.screen.active {
    display: flex;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.screen-content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

/* ================================
   Headers
   ================================ */

.screen-header {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding-bottom: var(--space-lg);
}

.screen-header h1 {
    flex: 1;
    font-size: var(--font-size-xl);
    font-weight: 600;
    text-align: center;
}

.spacer {
    width: var(--touch-min);
}

/* ================================
   Buttons
   ================================ */

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-xl);
    font-family: inherit;
    font-size: var(--font-size-base);
    font-weight: 700;
    color: #FFFFFF;
    background: var(--color-accent-primary);
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
    min-height: var(--touch-min);
    min-width: 140px;
    position: relative;
    box-shadow: 0 6px 0 #2E6BCA;
    /* 3D effect shadow */
    margin-bottom: 6px;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 #2E6BCA;
}

.btn:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 #2E6BCA;
}

.btn-primary {
    background: var(--color-accent-primary);
    box-shadow: 0 6px 0 #2E6BCA;
}

.btn-primary:active {
    box-shadow: 0 2px 0 #2E6BCA;
}

.btn-secondary {
    background: #FFFFFF;
    color: var(--color-accent-primary);
    border: 2px solid var(--color-accent-primary);
    box-shadow: 0 6px 0 var(--color-accent-primary);
}

.btn-secondary:active {
    box-shadow: 0 2px 0 var(--color-accent-primary);
}

.btn-large {
    padding: var(--space-lg) var(--space-2xl);
    font-size: var(--font-size-lg);
    min-height: 64px;
    width: 100%;
}

.btn-icon {
    font-size: var(--font-size-xl);
}

.text-btn {
    background: none;
    border: none;
    color: var(--color-text-secondary);
    font-family: inherit;
    font-size: var(--font-size-base);
    padding: var(--space-md);
    cursor: pointer;
    text-decoration: underline;
    min-height: var(--touch-min);
}

.text-btn:hover {
    color: var(--color-text-primary);
}

.icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--touch-min);
    height: var(--touch-min);
    background: var(--color-bg-card);
    border: none;
    border-radius: var(--radius-md);
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.icon-btn:hover {
    background: var(--color-bg-elevated);
}

.icon-btn svg {
    width: 24px;
    height: 24px;
}

/* ================================
   Welcome Screen (Braillito Design)
   ================================ */

/* Primary accent color */
:root {
    --color-primary-orange: #ff9045;
    --color-primary-orange-light: #ffedd5;
}

.welcome-screen {
    position: relative;
    overflow: hidden;
    background: var(--color-bg-primary);
    padding: 0 !important;
}

.welcome-bg-pattern {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(var(--color-primary-orange) 15%, transparent 15%),
        radial-gradient(var(--color-primary-orange) 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.04;
    pointer-events: none;
    z-index: 0;
}

.welcome-glow {
    position: absolute;
    top: -80px;
    right: -80px;
    width: 240px;
    height: 240px;
    background: rgba(255, 144, 69, 0.15);
    border-radius: 50%;
    filter: blur(60px);
    pointer-events: none;
    z-index: 0;
}

.welcome-header {
    position: relative;
    z-index: 10;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-lg);
    padding-top: var(--space-xl);
}

.braillito-logo {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.braille-cell-mini {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 3px;
}

.braille-cell-mini .dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
}

.braille-cell-mini .dot.filled {
    background: var(--color-text-primary);
}

.braille-cell-mini .dot.accent {
    background: var(--color-primary-orange);
}

.braillito-text {
    font-size: 1.25rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    color: var(--color-text-primary);
}

.welcome-main {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 0 var(--space-lg);
    max-width: 420px;
    margin: 0 auto;
    width: 100%;
}

.mascot-container {
    position: relative;
    width: 100%;
    display: flex;
    justify-content: center;
    margin-bottom: var(--space-xl);
}

.mascot-circle {
    position: relative;
    width: 220px;
    height: 220px;
    background: var(--color-primary-orange-light);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
        0 20px 60px rgba(255, 144, 69, 0.2),
        inset 0 0 0 4px white;
    animation: mascotFloat 3s ease-in-out infinite;
}

@keyframes mascotFloat {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.robot-svg {
    width: 160px;
    height: 160px;
}

.mascot-badge {
    position: absolute;
    right: 10%;
    bottom: 10%;
    background: var(--color-primary-orange);
    color: white;
    padding: 12px;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.3);
    transform: rotate(12deg);
    z-index: 20;
}

.badge-icon {
    font-size: 1.5rem;
    font-weight: bold;
}

.welcome-text {
    text-align: center;
    margin-bottom: var(--space-lg);
}

.welcome-title {
    font-size: 2rem;
    font-weight: 700;
    line-height: 1.2;
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
    letter-spacing: -0.02em;
}

.welcome-subtitle {
    font-size: 1.1rem;
    line-height: 1.5;
    color: var(--color-text-secondary);
    max-width: 320px;
    margin: 0 auto;
}

.welcome-footer {
    position: relative;
    z-index: 10;
    width: 100%;
    padding: var(--space-md) var(--space-lg);
    padding-bottom: calc(var(--space-xl) + env(safe-area-inset-bottom));
    max-width: 420px;
    margin: 0 auto;
}

.welcome-btn {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    border: none;
    border-radius: var(--radius-full);
    font-family: inherit;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: all 0.2s ease;
}

.welcome-btn.primary {
    height: 56px;
    padding: 0 var(--space-xl);
    background: var(--color-primary-orange);
    color: #0e1b13;
    font-size: 1.1rem;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.35);
    margin-bottom: var(--space-sm);
}

.welcome-btn.primary:hover {
    background: #ff7a20;
    transform: scale(1.02);
}

.welcome-btn.primary:active {
    transform: scale(0.98);
}

.welcome-btn.primary svg {
    width: 20px;
    height: 20px;
    transition: transform 0.2s ease;
}

.welcome-btn.primary:hover svg {
    transform: translateX(4px);
}

.welcome-btn.secondary {
    height: 48px;
    padding: 0 var(--space-lg);
    background: transparent;
    color: var(--color-text-primary);
    font-size: 0.875rem;
}

.welcome-btn.secondary:hover {
    background: rgba(0, 0, 0, 0.05);
}

/* High Contrast adjustments for welcome screen */
.high-contrast .welcome-screen {
    background: #000000;
}

.high-contrast .braille-cell-mini .dot.filled {
    background: #ffffff;
}

.high-contrast .braillito-text {
    color: #ffffff;
}

.high-contrast .mascot-circle {
    background: #1a1a1a;
    box-shadow: 0 0 0 3px var(--color-primary-orange);
}

.high-contrast .welcome-title {
    color: #ffffff;
}

.high-contrast .welcome-subtitle {
    color: #cccccc;
}

.high-contrast .welcome-btn.secondary {
    color: #ffffff;
}

.high-contrast .welcome-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ================================
   Dashboard Screen (New Braillito Design)
   ================================ */

.dashboard-new {
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0 !important;
    padding-bottom: 100px !important;
}

.dashboard-header-new {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-lg);
    padding-top: var(--space-xl);
}

.header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.streak-pill {
    display: flex;
    align-items: center;
    gap: 4px;
    background: white;
    padding: 6px 12px;
    border-radius: var(--radius-full);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.streak-icon {
    font-size: 1rem;
}

.streak-num {
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text-primary);
}

.avatar-circle {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--color-primary-orange);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.75rem;
    color: #0e1b13;
    box-shadow: var(--shadow-sm);
}

.dashboard-main {
    position: relative;
    z-index: 10;
    padding: 0 var(--space-lg);
    padding-bottom: 120px;
}

/* Welcome Card */
.welcome-card {
    background: white;
    border-radius: 2rem;
    padding: var(--space-lg);
    box-shadow: var(--shadow-md);
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-md);
    margin-bottom: var(--space-lg);
    position: relative;
    overflow: hidden;
}

.welcome-card::before {
    content: '';
    position: absolute;
    left: -20px;
    bottom: -40px;
    width: 100px;
    height: 100px;
    background: rgba(255, 144, 69, 0.08);
    border-radius: 50%;
    filter: blur(20px);
}

.welcome-card-content {
    flex: 1;
}

.greeting-new {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 4px;
    letter-spacing: -0.02em;
}

.greeting-sub {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--space-md);
}

.trend-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: #E8F5E9;
    color: #2E7D32;
    padding: 4px 10px;
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 700;
}

.welcome-mascot-mini {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
    background: var(--color-primary-orange-light);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 3px solid white;
    box-shadow: var(--shadow-sm);
}

.robot-svg-mini {
    width: 60px;
    height: 60px;
}

/* Section Labels */
.section-label {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
    padding-left: 4px;
}

/* Continue Learning Card */
.continue-card {
    width: 100%;
    background: var(--color-primary-orange);
    border-radius: 2rem;
    padding: var(--space-lg);
    border: none;
    cursor: pointer;
    text-align: left;
    box-shadow: 0 12px 32px rgba(255, 144, 69, 0.35);
    position: relative;
    overflow: hidden;
    margin-bottom: var(--space-lg);
    transition: transform 0.2s ease;
}

.continue-card:active {
    transform: scale(0.98);
}

.continue-card-inner {
    position: relative;
    z-index: 2;
}

.continue-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-md);
}

.level-badge {
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(8px);
    padding: 4px 12px;
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 700;
    color: #0e1b13;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.play-btn-icon {
    width: 40px;
    height: 40px;
    background: #0e1b13;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-primary-orange);
    transition: transform 0.2s ease;
}

.continue-card:hover .play-btn-icon {
    transform: scale(1.1);
}

.play-btn-icon svg {
    width: 20px;
    height: 20px;
}

.continue-level-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: #0e1b13;
    margin-bottom: 4px;
    letter-spacing: -0.02em;
}

.continue-lesson {
    font-size: 0.875rem;
    color: rgba(14, 27, 19, 0.7);
    font-weight: 500;
    margin-bottom: var(--space-xl);
}

.progress-section {
    margin-top: auto;
}

.progress-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.7rem;
    font-weight: 700;
    color: rgba(14, 27, 19, 0.7);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 8px;
}

.progress-track {
    width: 100%;
    height: 12px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: #0e1b13;
    border-radius: var(--radius-full);
    transition: width 0.5s ease;
}

.continue-bg-icon {
    position: absolute;
    right: 24px;
    bottom: -10px;
    font-size: 120px;
    color: rgba(0, 0, 0, 0.05);
    transform: rotate(12deg);
    font-weight: bold;
    z-index: 1;
    line-height: 1;
}

/* Stats Grid */
.stats-grid-new {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    margin-bottom: var(--space-lg);
}

.stat-card-new {
    background: white;
    border-radius: 2rem;
    padding: var(--space-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: var(--space-sm);
}

.stat-icon-circle {
    width: 48px;
    height: 48px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

.stat-card-new.blue .stat-icon-circle {
    background: #EBF5FF;
}

.stat-card-new.purple .stat-icon-circle {
    background: #F3E8FF;
}

.stat-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.stat-value-new {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    letter-spacing: -0.02em;
}

.stat-label-new {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Achievements Preview */
.achievements-preview {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.achievement-row {
    background: white;
    border-radius: var(--radius-lg);
    padding: var(--space-md);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.achievement-row.locked {
    opacity: 0.6;
}

.achievement-icon-box {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: var(--color-bg-elevated);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: var(--color-text-muted);
}

.achievement-info {
    flex: 1;
}

.achievement-info h4 {
    font-size: 1rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 2px;
}

.achievement-info p {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    font-weight: 500;
}

/* High Contrast - Dashboard */
.high-contrast .dashboard-new {
    background: #000000;
}

.high-contrast .welcome-card,
.high-contrast .stat-card-new,
.high-contrast .achievement-row {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .streak-pill {
    background: #1a1a1a;
    border-color: rgba(255, 255, 255, 0.2);
}

.high-contrast .continue-card {
    box-shadow: 0 0 0 2px var(--color-primary-orange);
}

.high-contrast .greeting-new,
.high-contrast .section-label,
.high-contrast .stat-value-new,
.high-contrast .achievement-info h4 {
    color: #ffffff;
}

/* ================================
   Onboarding Screen
   ================================ */

.onboarding-header {
    text-align: center;
    margin-bottom: var(--space-2xl);
}

.onboarding-header h1 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-sm);
}

.onboarding-header p {
    color: var(--color-text-secondary);
}

.settings-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    margin-bottom: var(--space-2xl);
}

.setting-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-md);
    padding: var(--space-lg);
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    border: 2px solid var(--color-bg-elevated);
}

.setting-info {
    flex: 1;
}

.setting-label {
    display: block;
    font-size: var(--font-size-base);
    font-weight: 600;
    margin-bottom: var(--space-xs);
}

.setting-description {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

/* Toggle Switch */
.toggle-switch {
    position: relative;
    width: 56px;
    height: 32px;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}

.toggle-track {
    display: block;
    width: 100%;
    height: 100%;
    background: var(--color-bg-elevated);
    border-radius: var(--radius-full);
    transition: all var(--transition-base);
}

.toggle-thumb {
    position: absolute;
    top: 4px;
    left: 4px;
    width: 24px;
    height: 24px;
    background: #FFFFFF;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: all var(--transition-base);
}

.toggle-switch[aria-checked="true"] .toggle-track {
    background: var(--color-success);
}

.toggle-switch[aria-checked="true"] .toggle-thumb {
    left: calc(100% - 28px);
}

/* Size Selector */
.size-selector {
    display: flex;
    gap: var(--space-sm);
}

.size-option {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-elevated);
    border: 2px solid transparent;
    border-radius: var(--radius-md);
    color: var(--color-text-secondary);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.size-option:nth-child(1) {
    font-size: var(--font-size-sm);
}

.size-option:nth-child(2) {
    font-size: var(--font-size-base);
}

.size-option:nth-child(3) {
    font-size: var(--font-size-lg);
}

.size-option.active,
.size-option[aria-checked="true"] {
    border-color: var(--color-accent-primary);
    color: var(--color-accent-primary);
    background: #FFFFFF;
    box-shadow: 0 4px 0 var(--color-accent-primary);
    transform: translateY(-2px);
}

/* ================================
   Profile Setup
   ================================ */

.profile-header {
    text-align: center;
    margin-bottom: var(--space-2xl);
}

.profile-header h1 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-sm);
}

.profile-form {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.form-label {
    font-size: var(--font-size-base);
    font-weight: 600;
}

.form-input {
    padding: var(--space-lg);
    background: var(--color-bg-card);
    border: 2px solid var(--color-dot-border);
    border-radius: var(--radius-lg);
    color: var(--color-text-primary);
    font-family: inherit;
    font-size: var(--font-size-base);
    min-height: var(--touch-min);
    transition: border-color var(--transition-fast);
}

.form-input:focus {
    border-color: var(--color-accent-primary);
}

.form-input::placeholder {
    color: var(--color-text-muted);
}

.form-hint {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.age-options {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-md);
}

.age-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-lg);
    background: var(--color-bg-card);
    border: 2px solid transparent;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.age-option:hover {
    background: var(--color-bg-elevated);
}

.age-option.active,
.age-option[aria-checked="true"] {
    border-color: var(--color-accent-primary);
    background: rgba(108, 99, 255, 0.1);
}

.age-icon {
    font-size: var(--font-size-3xl);
}

.age-label {
    font-weight: 600;
}

.age-range {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.profile-actions {
    display: flex;
    gap: var(--space-md);
    margin-top: auto;
}

.profile-actions .btn {
    flex: 1;
}

/* ================================
   Dashboard
   ================================ */

.dashboard-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: var(--space-xl);
}

.user-greeting h1 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-sm);
}

.streak-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-md);
    background: #FFFAF0;
    border: 2px solid #FFCC85;
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    font-weight: 700;
    color: var(--color-warning);
    box-shadow: 0 4px 0 rgba(255, 179, 71, 0.1);
}

.streak-icon {
    font-size: var(--font-size-lg);
}

.dashboard-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
}

/* Learning Progress Card */
.learning-progress-card {
    padding: var(--space-lg);
    background: linear-gradient(135deg, #FFFFFF 0%, #F0F8FF 100%);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-sm);
    border: 2px solid var(--color-bg-elevated);
}

.learning-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: var(--space-md);
}

.learning-stats .stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
}

.learning-stats .stat-value {
    font-size: var(--font-size-3xl);
    font-weight: 800;
    color: var(--color-accent-primary);
}

.learning-stats .stat-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-secondary);
    font-weight: 600;
}

.learning-bar-container {
    margin-bottom: var(--space-sm);
}

.learning-bar {
    height: 12px;
    background: var(--color-bg-elevated);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin-bottom: var(--space-xs);
}

.learning-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--color-accent-tertiary) 0%, var(--color-accent-primary) 100%);
    border-radius: var(--radius-full);
    transition: width var(--transition-slow);
}

.learning-next {
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--color-accent-primary);
}

.learning-message {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    text-align: center;
    margin-top: var(--space-sm);
}

/* Continue Learning Button */
.continue-learning-btn {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-lg);
    background: var(--color-accent-primary);
    border: none;
    border-radius: var(--radius-xl);
    cursor: pointer;
    width: 100%;
    text-align: left;
    box-shadow: 0 6px 0 #2E6BCA;
    transition: all var(--transition-fast);
}

.continue-learning-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 #2E6BCA;
}

.continue-learning-btn:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 #2E6BCA;
}

.continue-icon {
    font-size: var(--font-size-3xl);
}

.continue-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.continue-title {
    font-size: var(--font-size-lg);
    font-weight: 700;
    color: #FFFFFF;
}

.continue-subtitle {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.9);
}

.continue-subtitle strong {
    font-weight: 700;
}

.continue-arrow {
    font-size: var(--font-size-2xl);
    color: #FFFFFF;
    opacity: 0.8;
}

/* Daily Challenge Card */
.daily-challenge-card {
    padding: var(--space-lg);
    background: linear-gradient(135deg, #FFF9E6 0%, #FFFBF0 100%);
    border: 2px solid var(--color-accent-quaternary);
    border-radius: var(--radius-xl);
}

.challenge-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-sm);
}

.challenge-tag {
    font-size: var(--font-size-xs);
    font-weight: 700;
    color: var(--color-accent-quaternary);
}

.challenge-bonus {
    font-size: var(--font-size-xs);
    font-weight: 600;
    color: var(--color-accent-primary);
    background: rgba(71, 145, 255, 0.1);
    padding: 2px 8px;
    border-radius: var(--radius-full);
}

.challenge-task {
    font-size: var(--font-size-base);
    font-weight: 600;
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
}

.challenge-btn {
    width: 100%;
    padding: var(--space-md);
    background: var(--color-accent-quaternary);
    color: #FFFFFF;
    border: none;
    border-radius: var(--radius-lg);
    font-weight: 700;
    font-size: var(--font-size-base);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.challenge-btn:hover {
    background: #D4A000;
}

/* Nav Grid with Descriptions */
.nav-grid .nav-desc {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    margin-top: var(--space-xs);
}

/* Cognitive Benefits */
.cognitive-benefits {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md);
    background: linear-gradient(135deg, #F0FFF0 0%, #F8FFF8 100%);
    border-radius: var(--radius-lg);
    border: 1px solid #C8E6C8;
}

.benefit-icon {
    font-size: var(--font-size-2xl);
}

.benefit-text {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    font-weight: 500;
}

/* Greeting Improvements */
.greeting-subtitle {
    font-size: var(--font-size-base);
    color: var(--color-text-secondary);
    margin-top: var(--space-xs);
    margin-bottom: var(--space-sm);
}

.streak-encouragement {
    font-size: var(--font-size-xs);
    color: var(--color-accent-secondary);
    font-weight: 600;
    margin-left: var(--space-xs);
}

.action-title {
    font-size: var(--font-size-lg);
    font-weight: 700;
    color: var(--color-text-primary);
}

.action-desc {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.action-card.primary .action-desc {
    color: rgba(255, 255, 255, 0.8);
}

.badge-new {
    position: absolute;
    top: var(--space-md);
    right: var(--space-md);
    padding: var(--space-xs) var(--space-sm);
    background: var(--color-accent-secondary);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: 700;
    color: white;
    animation: pulse 2s infinite;
}

@keyframes pulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.7;
    }
}

/* Navigation Grid */
.nav-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
}

.nav-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xl) var(--space-md);
    background: #FFFFFF;
    border: none;
    border-radius: var(--radius-xl);
    cursor: pointer;
    transition: all var(--transition-fast);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    margin-bottom: 6px;
}

.nav-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 var(--color-bg-elevated);
}

.nav-card:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 var(--color-bg-elevated);
}

.nav-card:nth-child(1) .nav-icon {
    color: var(--color-accent-primary);
}

.nav-card:nth-child(2) .nav-icon {
    color: var(--color-accent-tertiary);
}

.nav-card:nth-child(3) .nav-icon {
    color: var(--color-accent-secondary);
}

.nav-card:nth-child(4) .nav-icon {
    color: var(--color-accent-quaternary);
}

.nav-icon {
    font-size: var(--font-size-3xl);
}

.nav-label {
    font-size: var(--font-size-base);
    font-weight: 700;
    color: var(--color-text-primary);
}

/* Floating Action Button */
.fab {
    position: fixed;
    bottom: calc(var(--space-xl) + env(safe-area-inset-bottom));
    right: var(--space-lg);
    width: 56px;
    height: 56px;
    background: var(--gradient-primary);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    box-shadow: var(--shadow-lg);
    transition: all var(--transition-base);
    z-index: 100;
}

.fab:hover {
    transform: scale(1.1);
}

.fab svg {
    width: 28px;
    height: 28px;
}

/* ================================
   Levels Map
   ================================ */

.levels-content {
    flex: 1;
    overflow-y: auto;
    max-height: calc(100vh - 120px);
    padding-bottom: var(--space-2xl);
}

.chapter {
    margin-bottom: var(--space-2xl);
}

.chapter-title {
    font-size: var(--font-size-lg);
    font-weight: 800;
    color: var(--color-accent-primary);
    margin-bottom: var(--space-md);
    padding: var(--space-xs) var(--space-md);
    background: #FFFFFF;
    display: inline-block;
    border-radius: var(--radius-full);
    box-shadow: var(--shadow-sm);
    border: 2px solid var(--color-bg-elevated);
}

.levels-grid {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    padding: var(--space-sm);
}

.level-node {
    display: flex;
    align-items: center;
    gap: var(--space-lg);
    padding: var(--space-md) var(--space-lg);
    background: #FFFFFF;
    border: none;
    border-radius: var(--radius-xl);
    cursor: pointer;
    transition: all var(--transition-fast);
    width: 100%;
    text-align: left;
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    margin-bottom: 6px;
    position: relative;
}

.level-node:hover:not(.locked) {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 var(--color-bg-elevated);
}

.level-node:active:not(.locked) {
    transform: translateY(4px);
    box-shadow: 0 2px 0 var(--color-bg-elevated);
}

.level-node.locked {
    opacity: 0.7;
    cursor: not-allowed;
    background: #E8EEFB;
    box-shadow: none;
    transform: none;
}

.level-node.completed {
    box-shadow: 0 6px 0 rgba(71, 209, 160, 0.2);
}

.level-circle {
    position: relative;
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-elevated);
    border-radius: 50%;
    flex-shrink: 0;
    box-shadow: inset 0 -4px 0 rgba(0, 0, 0, 0.05);
}

.level-node.unlocked .level-circle {
    background: var(--color-accent-primary);
    color: #FFFFFF;
}

.level-node.completed .level-circle {
    background: var(--color-success);
    color: #FFFFFF;
}

.level-number {
    font-size: var(--font-size-xl);
    font-weight: 700;
}

.lock-icon,
.premium-icon {
    position: absolute;
    bottom: -4px;
    right: -4px;
    font-size: var(--font-size-sm);
}

.level-title {
    flex: 1;
    font-size: var(--font-size-base);
    font-weight: 600;
}

.level-requirement {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

.level-stars {
    display: flex;
    gap: 2px;
}

.star {
    font-size: var(--font-size-base);
    color: var(--color-text-muted);
}

.star.earned {
    color: var(--color-warning);
}

/* ================================
   Levels Screen (New Braillito Design)
   ================================ */

.levels-new {
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0 !important;
    background: var(--color-bg-primary);
}

.levels-header-new {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 40;
    background: rgba(246, 248, 247, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    padding: 12px 16px;
    padding-top: calc(12px + env(safe-area-inset-top));
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 100%;
}

.header-stats {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.stat-pill {
    display: flex;
    align-items: center;
    gap: 6px;
    background: white;
    padding: 6px 12px;
    border-radius: var(--radius-full);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.stat-pill.bolt {
    color: #e67a2e;
}

.stat-pill.heart {
    color: #ef4444;
}

.stat-emoji {
    font-size: 1rem;
}

.stat-num {
    font-weight: 700;
    font-size: 0.875rem;
}

.levels-main {
    position: relative;
    z-index: 10;
    padding: 100px var(--space-md) 120px;
    width: 100%;
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
    box-sizing: border-box;
}

/* Unit Card */
.unit-card {
    background: var(--color-primary-orange);
    border-radius: 24px;
    padding: var(--space-lg);
    box-shadow: 0 12px 32px rgba(255, 144, 69, 0.3);
    position: relative;
    overflow: hidden;
    margin-bottom: 40px;
}

.unit-bg-circle {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
}

.unit-bg-circle.top {
    top: -50%;
    right: -30%;
    width: 120px;
    height: 120px;
    background: rgba(255, 255, 255, 0.1);
}

.unit-bg-circle.bottom {
    bottom: -50%;
    left: -20%;
    width: 100px;
    height: 100px;
    background: rgba(0, 0, 0, 0.05);
}

.unit-content {
    position: relative;
    z-index: 2;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.unit-info {
    flex: 1;
}

.unit-label {
    display: block;
    font-size: 0.7rem;
    font-weight: 900;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: rgba(14, 27, 19, 0.7);
    margin-bottom: 8px;
}

.unit-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #0e1b13;
    line-height: 1.2;
    margin-bottom: 8px;
}

.unit-lessons {
    font-size: 0.875rem;
    font-weight: 500;
    color: rgba(14, 27, 19, 0.8);
}

.unit-book-btn {
    width: 44px;
    height: 44px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(8px);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s ease;
}

.unit-book-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.unit-book-icon {
    font-size: 1.25rem;
}

/* Lessons Path */
.lessons-path {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 32px;
}

.lesson-node-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    position: relative;
    width: 100%;
}

.lesson-node-row.left {
    align-items: flex-start;
    padding-left: 20%;
}

.lesson-node-row.right {
    align-items: flex-end;
    padding-right: 10%;
}

.lesson-node-row.center {
    align-items: center;
}

.lesson-node-row.featured {
    flex-direction: row;
    justify-content: flex-end;
    gap: 16px;
}

/* Lesson Nodes */
.lesson-node {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    position: relative;
}

.lesson-node.completed {
    background: #fbbf24;
    border-bottom: 6px solid #d97706;
    color: #0e1b13;
}

.lesson-node.completed:active {
    border-bottom-width: 2px;
    transform: translateY(4px);
}

.lesson-node.current {
    width: 96px;
    height: 96px;
    background: var(--color-primary-orange);
    border-bottom: 6px solid #e67a2e;
    color: #0e1b13;
}

.lesson-node.current:active {
    border-bottom-width: 2px;
    transform: translateY(4px);
}

.lesson-node.locked {
    background: #e5e7eb;
    border-bottom: 6px solid #d1d5db;
    color: #9ca3af;
    cursor: not-allowed;
}

.lesson-node.exam-node {
    width: 96px;
    height: 80px;
    border-radius: 16px;
}

.node-icon {
    font-size: 2rem;
    font-weight: bold;
}

.node-icon.play {
    font-size: 2.5rem;
}

/* Pulsing Animation for Current */
.lesson-node.pulsing .pulse-ring {
    position: absolute;
    inset: 0;
    background: rgba(255, 144, 69, 0.2);
    border-radius: 50%;
    animation: pulsate 2s ease-out infinite;
}

@keyframes pulsate {
    0% {
        transform: scale(1);
        opacity: 1;
    }

    100% {
        transform: scale(1.5);
        opacity: 0;
    }
}

/* Stars */
.lesson-stars {
    display: flex;
    gap: 4px;
    margin-top: 4px;
}

.lesson-stars .star {
    font-size: 1.1rem;
}

.lesson-stars .star.filled {
    color: #fbbf24;
}

/* Lesson Info Labels */
.lesson-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    margin-top: 8px;
    max-width: 140px;
}

.lesson-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-primary);
    line-height: 1.3;
}

.lesson-xp {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-text-muted);
    margin-top: 2px;
}

/* Adjust row layout for info */
.lesson-node-row {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    position: relative;
    width: 100%;
}

.lesson-node-row.featured {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
}

.lesson-node-row.featured .lesson-info {
    order: 3;
    width: 100%;
}

/* High Contrast - Lesson Info */
.high-contrast .lesson-title {
    color: #ffffff;
}

.high-contrast .lesson-xp {
    color: #999999;
}

/* Mascot Bubble */
.mascot-bubble {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    position: relative;
}

.mascot-speech {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.08);
    color: var(--color-text-primary);
    font-size: 0.75rem;
    font-weight: 700;
    padding: 8px 12px;
    border-radius: 16px;
    border-bottom-right-radius: 4px;
    box-shadow: var(--shadow-md);
    white-space: nowrap;
    animation: bounceSlow 3s ease-in-out infinite;
}

@keyframes bounceSlow {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-6px);
    }
}

.mascot-mini-avatar {
    width: 80px;
    height: 80px;
    filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.1));
}

.robot-svg-tiny {
    width: 100%;
    height: 100%;
}

/* Exam */
.lesson-node-row.exam {
    flex-direction: column;
    margin-top: 16px;
}

.exam-label {
    font-size: 0.7rem;
    font-weight: 900;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: #9ca3af;
    margin-top: 8px;
}

/* ================================
   Card-Based Levels List
   ================================ */

.levels-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
}

.chapter-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
}

/* Orange Unit Card */
.unit-card-new {
    background: var(--color-primary-orange);
    border-radius: 24px;
    padding: var(--space-lg);
    box-shadow: 0 12px 32px rgba(255, 144, 69, 0.3);
    position: relative;
    overflow: hidden;
    transition: all 0.2s ease;
}

.unit-card-new:active {
    transform: scale(0.98);
}

.unit-card-new.locked {
    background: #d1d5db;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    opacity: 0.7;
}

.unit-card-new .unit-bg-circle {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
}

.unit-card-new .unit-bg-circle.top {
    top: -50%;
    right: -30%;
    width: 120px;
    height: 120px;
    background: rgba(255, 255, 255, 0.1);
}

.unit-card-new .unit-bg-circle.bottom {
    bottom: -50%;
    left: -20%;
    width: 100px;
    height: 100px;
    background: rgba(0, 0, 0, 0.05);
}

.unit-card-new .unit-content {
    position: relative;
    z-index: 2;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.unit-card-new .unit-info {
    flex: 1;
}

.unit-card-new .unit-label {
    font-size: 0.625rem;
    font-weight: 900;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: rgba(14, 27, 19, 0.7);
    margin-bottom: 4px;
    display: block;
}

.unit-card-new .unit-title {
    font-size: 1.375rem;
    font-weight: 700;
    color: #0e1b13;
    line-height: 1.2;
    margin: 0;
}

.unit-card-new .unit-progress {
    font-size: 0.875rem;
    font-weight: 500;
    color: rgba(14, 27, 19, 0.9);
    margin: 6px 0 0;
}

.unit-card-new .unit-book-btn {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    border-radius: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s ease;
    color: #0e1b13;
    flex-shrink: 0;
}

.unit-card-new .unit-book-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.unit-card-new .unit-book-icon {
    font-size: 1.5rem;
}

/* High Contrast - Unit Card */
.high-contrast .unit-card-new {
    box-shadow: 0 0 0 2px var(--color-primary-orange);
}

.high-contrast .unit-card-new.locked {
    box-shadow: 0 0 0 2px #9ca3af;
}

.chapter-cards {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.level-card {
    display: flex;
    align-items: center;
    gap: var(--space-lg);
    padding: var(--space-md) var(--space-lg);
    background: #ffffff;
    border: none;
    border-radius: 24px;
    cursor: pointer;
    transition: all var(--transition-fast);
    width: 100%;
    text-align: left;
    box-shadow: 0 4px 0 var(--color-bg-elevated);
    margin-bottom: 4px;
    position: relative;
}

.level-card:hover:not(.locked) {
    transform: translateY(-2px);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
}

.level-card:active:not(.locked) {
    transform: translateY(3px);
    box-shadow: 0 1px 0 var(--color-bg-elevated);
}

.level-card.locked {
    opacity: 0.7;
    cursor: not-allowed;
    background: #E8EEFB;
    box-shadow: none;
}

.level-card.completed {
    box-shadow: 0 4px 0 rgba(71, 209, 160, 0.2);
}

/* Level Card Circle */
.level-card-circle {
    position: relative;
    width: 56px;
    height: 56px;
    min-width: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-elevated);
    border-radius: 50%;
    flex-shrink: 0;
}

.level-card-circle.unlocked {
    background: var(--color-accent-primary);
    color: #ffffff;
}

.level-card-circle.current {
    background: var(--color-primary-orange);
    color: #0e1b13;
}

.level-card-circle.completed {
    background: var(--color-success);
    color: #ffffff;
}

.level-card-circle.locked {
    background: #e5e7eb;
    color: #9ca3af;
}

/* Circle Icon */
.circle-icon {
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1;
}

.circle-icon.check {
    font-size: 1.75rem;
    font-weight: 900;
}

.circle-icon.play {
    font-size: 1.25rem;
    margin-left: 2px;
}

/* Level Card Info */
.level-card-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.level-card-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-primary);
}

/* Level Card Subtitle */
.level-card-subtitle {
    font-size: 0.875rem;
    font-weight: 500;
}

.level-card-subtitle.muted {
    color: var(--color-text-muted);
}

.level-card-subtitle.current {
    color: var(--color-primary-orange);
    font-weight: 600;
}

.level-card-stars {
    display: flex;
    gap: 2px;
}

.star-mini {
    font-size: 0.875rem;
    color: #d1d5db;
}

.star-mini.earned {
    color: #fbbf24;
}

/* Orange Accent for Current Card */
.level-card-accent {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 6px;
    background: var(--color-primary-orange);
    border-radius: 0 24px 24px 0;
}

/* Current card styling */
.level-card.current {
    border: 2px solid rgba(255, 144, 69, 0.2);
    box-shadow: 0 6px 20px rgba(255, 144, 69, 0.15);
}

/* High Contrast - Card Levels */
.high-contrast .levels-new {
    background: #000000;
}

.high-contrast .levels-header-new {
    background: rgba(0, 0, 0, 0.95);
    border-bottom-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .stat-pill {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.2);
}

.high-contrast .chapter-pill {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.2);
    color: var(--color-primary-orange);
}

.high-contrast .level-card {
    background: #141414;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.high-contrast .level-card.locked {
    background: #0A0A0A;
    opacity: 0.6;
}

.high-contrast .level-card-circle {
    background: #222222;
}

.high-contrast .level-card-title {
    color: #ffffff;
}

/* ================================
   Lesson Intro
   ================================ */

.lesson-intro-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding-top: var(--space-sm);
}

.lesson-icon {
    margin-bottom: var(--space-md);
}

.braille-demo-cell {
    display: grid;
    grid-template-columns: repeat(2, auto);
    place-items: center;
    gap: 10px;
    padding: 14px;
    background: #FFFFFF;
    border-radius: var(--radius-xl);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    border: 2px solid var(--color-bg-elevated);
    width: fit-content;
    min-width: 120px;
    margin: 0 auto;
}

.braille-demo-cell.large {
    min-width: 140px;
}

.braille-demo-cell .dot {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--color-dot-unraised);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-base);
    font-weight: 700;
    color: var(--color-text-secondary);
}

.braille-demo-cell .dot.filled {
    background: var(--color-dot-raised);
    box-shadow: inset 0 -4px 0 rgba(0, 0, 0, 0.1);
    color: #FFFFFF;
}

.lesson-intro-content h2 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-md);
}

.lesson-desc {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    max-width: 320px;
    margin-bottom: var(--space-md);
    line-height: 1.4;
}

/* Two-step lesson intro */
.lesson-step {
    animation: slideInRight var(--transition-base) ease-out;
}

.lesson-step.hidden {
    display: none;
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(20px);
    }

    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.lesson-objectives-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
    margin-bottom: var(--space-xl);
}

.lesson-objectives-header .objectives-icon {
    font-size: 48px;
}

.lesson-objectives-header h2 {
    font-size: var(--font-size-xl);
    text-align: center;
    margin: 0;
}

.lesson-objectives {
    width: 100%;
    text-align: left;
    padding: var(--space-md);
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    border: 2px solid var(--color-bg-elevated);
    box-shadow: var(--shadow-sm);
    margin-bottom: var(--space-md);
}

.lesson-objectives h3 {
    font-size: var(--font-size-base);
    margin-bottom: var(--space-md);
    color: var(--color-text-secondary);
}

.lesson-objectives ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.lesson-objectives li {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--font-size-base);
}

.lesson-objectives li::before {
    content: "";
    color: var(--color-success);
    flex-shrink: 0;
}

/* Letters preview */
.lesson-letters-preview {
    width: 100%;
    text-align: center;
    margin-bottom: var(--space-lg);
}

.lesson-letters-preview h3 {
    font-size: var(--font-size-base);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-md);
}

.letters-preview-grid {
    display: flex;
    justify-content: center;
    gap: var(--space-sm);
    flex-wrap: wrap;
}

.letter-preview-item {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    font-size: var(--font-size-xl);
    font-weight: 700;
    color: var(--color-accent-primary);
    box-shadow: 0 4px 0 var(--color-bg-elevated);
    border: 2px solid var(--color-bg-elevated);
}

.lesson-intro-content .btn {
    margin-top: auto;
}

/* ================================
   Instruction Screen
   ================================ */


.instruction-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    gap: var(--space-xs);
    padding-bottom: var(--space-sm);
    padding-top: 0;
    max-height: 100%;
    overflow: hidden;
}

.instruction-letter-container {
    background: #FFFFFF;
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-xl);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    border: 2px solid var(--color-bg-elevated);
    flex-shrink: 0;
}

.instruction-letter {
    font-size: var(--font-size-3xl);
    font-weight: 800;
    color: var(--color-accent-primary);
}

/* Dual cell container for uppercase/numbers */
.braille-instruction-dual-container {
    display: flex;
    gap: var(--space-md);
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.braille-instruction-dual-container.single-cell #instruction-cell-prefix {
    display: none;
}

.braille-instruction-cell {
    display: grid;
    grid-template-columns: repeat(2, auto);
    place-items: center;
    gap: 12px;
    padding: 20px;
    background: #FFFFFF;
    border-radius: var(--radius-xl);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    border: 2px solid var(--color-bg-elevated);
    width: fit-content;
    min-width: 180px;
    flex-shrink: 0;
    position: relative;
}

.braille-instruction-cell .cell-label {
    display: none;
}

/* ================================
   New Pick Game Styles (Repaso Style)
   ================================ */

.pick-options-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    width: 100%;
    max-width: 400px;
    margin: 0 auto;
}

.pick-option-cell {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    /* Make them square */
    padding: var(--space-md);
    background: var(--color-bg-card);
    border: 2px solid var(--color-dot-unraised);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    transition: all var(--transition-base);
    cursor: pointer;
}

.pick-option-cell:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
    border-color: var(--color-dot-border);
    background: var(--color-bg-elevated);
}

.pick-option-cell:active,
.pick-option-cell.selected {
    transform: scale(0.98);
    border-color: var(--color-accent-primary);
    background: rgba(59, 130, 246, 0.05);
    /* Tint of primary */
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}

/* Correct/Incorrect states */
.pick-option-cell.correct {
    border-color: var(--color-success);
    background: rgba(16, 185, 129, 0.1);
    box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3);
}

.pick-option-cell.incorrect {
    border-color: var(--color-error);
    background: rgba(239, 68, 68, 0.1);
    animation: shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
}

.pick-braille-container {
    display: flex;
    gap: var(--space-md);
    pointer-events: none;
    /* Let clicks pass to button */
}

/* Individual Braille Formatting */
.pick-braille-char {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 6px;
    /* Slightly larger gap for clarity */
    padding: 4px;
}

.pick-dot {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: var(--color-dot-unraised);
    transition: background-color 0.2s ease;
}

.pick-dot.filled {
    background-color: var(--color-text-primary);
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* High Contrast Adjustments */
.high-contrast .pick-option-cell {
    border-width: 3px;
    background: #000;
}

.high-contrast .pick-option-cell.selected {
    border-color: var(--color-accent-primary);
    background: #111;
}

.high-contrast .pick-dot.filled {
    background-color: var(--color-dot-raised);
    /* Yellow/bright in HC */
}

/* Hide labels as requested */
.pick-option-label {
    display: none !important;
}

/* Question Area Styling */
.pick-question-text {
    font-size: var(--font-size-lg);
    font-weight: 600;
}

.pick-target-letter {
    font-size: var(--font-size-2xl);
    font-weight: 800;
    color: var(--color-accent-primary);
    margin: 0 0.2em;
}

/* Mascot integration */
.pick-mascot-container {
    margin-bottom: var(--space-md);
    display: flex;
    justify-content: center;
}

.braille-instruction-cell .dot {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: var(--color-dot-unraised);
    transition: all var(--transition-base);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-xl);
    font-weight: 700;
    color: var(--color-text-secondary);
}

.braille-instruction-cell .dot.filled {
    background: var(--color-dot-raised);
    box-shadow: inset 0 -4px 0 rgba(0, 0, 0, 0.1);
    transform: scale(1.05);
    color: #FFFFFF;
}

.braille-instruction-cell .dot.animating {
    animation: dotPulse 0.6s ease-in-out infinite;
    background: var(--color-accent-secondary);
}

@keyframes dotPulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }
}

.instruction-text-container {
    text-align: center;
    min-height: 2.5em;
    flex-shrink: 0;
}

.instruction-text {
    font-size: var(--font-size-2xl);
    font-weight: 600;
    color: var(--color-text-primary);
}

.instruction-progress {
    display: flex;
    justify-content: center;
    width: 100%;
    flex-shrink: 0;
}

.progress-dots {
    display: flex;
    justify-content: center;
    gap: var(--space-xs);
    flex-wrap: wrap;
    max-width: 100%;
}

.instruction-actions {
    display: flex;
    gap: var(--space-md);
    width: 100%;
    margin-top: auto;
    flex-shrink: 0;
    padding-top: var(--space-sm);
}

.instruction-actions .btn {
    flex: 1;
    padding: var(--space-sm) var(--space-md);
}

.progress-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: var(--color-bg-elevated);
    transition: all var(--transition-base);
    border: 2px solid var(--color-bg-elevated);
}

.progress-dot.active {
    background: var(--color-accent-primary);
    border-color: #76ABFF;
    transform: scale(1.2);
}

.progress-dot.completed {
    background: var(--color-success);
    border-color: #68E5BB;
}

/* ================================
   Game Screens
   ================================ */

.game-header {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding-bottom: var(--space-sm);
}

.game-progress {
    flex: 1;
    height: 16px;
    background: var(--color-bg-elevated);
    border-radius: var(--radius-full);
    position: relative;
    overflow: hidden;
    border: 2px solid var(--color-bg-elevated);
}

.progress-fill {
    height: 100%;
    background: #0e1b13;
    border-radius: var(--radius-full);
    transition: width var(--transition-base);
}

.progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--font-size-xs);
    font-weight: 600;
    color: transparent;
}

.game-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
    padding-top: var(--space-sm);
}

/* Game Prompt */
.game-prompt {
    text-align: center;
}

.prompt-instruction {
    font-size: var(--font-size-lg);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-xs);
}

.target-letter {
    font-size: var(--font-size-4xl);
    font-weight: 800;
    color: var(--color-accent-primary);
    line-height: 1;
}

.audio-btn {
    display: none;
}

.audio-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 var(--color-bg-elevated);
}

.audio-btn:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 var(--color-bg-elevated);
}

.audio-btn svg {
    width: 24px;
    height: 24px;
}

/* Braille Builder */
.braille-builder {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
}

.braille-cell.interactive {
    display: grid;
    grid-template-columns: repeat(2, auto);
    place-items: center;
    gap: 16px;
    padding: 18px;
    background: var(--color-bg-card);
    border-radius: var(--radius-xl);
    box-shadow: 0 6px 0 var(--color-bg-elevated);
    border: 2px solid var(--color-bg-elevated);
    width: fit-content;
    min-width: 200px;
}

.dot-btn {
    position: relative;
    width: 80px;
    height: 80px;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}

.dot-visual {
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: var(--color-dot-unraised);
    border: 3px solid var(--color-dot-border);
    transition: all var(--transition-fast);
}

.dot-btn[aria-checked="true"] .dot-visual {
    background: var(--color-dot-raised);
    border-color: var(--color-accent-primary);
    box-shadow: var(--shadow-glow);
    transform: scale(1.05);
}

.dot-number {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--font-size-2xl);
    font-weight: 700;
    color: var(--color-text-secondary);
    pointer-events: none;
    z-index: 1;
    opacity: 0.8;
}

.dot-btn[aria-checked="true"] .dot-number {
    color: #FFFFFF;
    opacity: 1;
}

.cell-hint {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    text-align: center;
    margin-top: var(--space-xs);
}

/* Constructor dual de celdas Braille para maysculas/nmeros */
.braille-builder-dual {
    display: flex;
    gap: var(--space-md);
    align-items: flex-start;
    justify-content: center;
}

.braille-builder-dual.single-cell #build-prefix-cell {
    display: none;
}

.braille-builder-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
}

.braille-builder-cell .braille-cell.interactive {
    gap: 10px;
    padding: 12px;
    width: fit-content;
    min-width: 140px;
}

.braille-builder-dual .dot-btn {
    width: 56px;
    height: 56px;
}

.braille-builder-dual .dot-number {
    font-size: var(--font-size-base);
}

.build-cell-label {
    display: none;
}

.braille-builder-cell.active .braille-cell.interactive {
    border: 3px solid var(--color-accent-primary);
    box-shadow: 0 0 0 4px rgba(66, 133, 244, 0.2);
}

/* Options Grid (Pick Cell) */
.options-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    width: 100%;
    max-width: 340px;
}

.option-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-md);
    background: var(--color-bg-card);
    border: 3px solid transparent;
    border-radius: var(--radius-xl);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.option-cell:hover {
    background: var(--color-bg-elevated);
    border-color: var(--color-dot-border);
}

.option-cell.selected {
    border-color: var(--color-accent-primary);
}

.option-cell.correct {
    border-color: var(--color-success);
    background: #F0FFF4;
    box-shadow: 0 4px 0 var(--color-success);
}

.option-cell.incorrect {
    border-color: var(--color-error);
    background: #FFF5F5;
    box-shadow: 0 4px 0 var(--color-error);
}

.option-braille {
    display: grid;
    grid-template-columns: repeat(2, auto);
    place-items: center;
    justify-content: center;
    gap: 10px;
}

.option-braille .dot {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: var(--color-dot-unraised);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-base);
    font-weight: 700;
    color: var(--color-text-secondary);
}

.option-braille .dot.filled {
    background: var(--color-dot-raised);
    box-shadow: inset 0 -3px 0 rgba(0, 0, 0, 0.1);
    color: #FFFFFF;
}

.option-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

/* Feedback Overlay */
.feedback-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    animation: fadeIn var(--transition-fast);
}

.feedback-overlay.hidden {
    display: none;
}

.feedback-content {
    text-align: center;
    padding: var(--space-2xl);
    background: #FFFFFF;
    border-radius: var(--radius-xl);
    max-width: 300px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    border: 4px solid var(--color-bg-elevated);
    animation: popIn var(--transition-base);
}

@keyframes popIn {
    from {
        transform: scale(0.8);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.feedback-icon {
    font-size: 64px;
    margin-bottom: var(--space-lg);
}

.feedback-content h2 {
    font-size: var(--font-size-2xl);
    margin-bottom: var(--space-sm);
}

.feedback-content p {
    color: var(--color-text-secondary);
    margin-bottom: var(--space-xl);
}

.feedback-overlay.success .feedback-icon {
    color: var(--color-success);
}

.feedback-overlay.error .feedback-icon {
    color: var(--color-error);
}

/* Exit Confirmation Actions */
.exit-confirm-actions {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    width: 100%;
}

.exit-confirm-actions .btn {
    width: 100%;
}

/* ================================
   Results Screen
   ================================ */

.results-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding-top: var(--space-2xl);
}

.results-celebration {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 200px;
    pointer-events: none;
    overflow: hidden;
}

.stars-display {
    display: flex;
    gap: var(--space-md);
    margin-bottom: var(--space-xl);
}

.result-star {
    font-size: var(--font-size-4xl);
    color: var(--color-text-muted);
    animation: starPop 0.5s ease forwards;
    opacity: 0;
}

.result-star:nth-child(1) {
    animation-delay: 0.2s;
}

.result-star:nth-child(2) {
    animation-delay: 0.4s;
}

.result-star:nth-child(3) {
    animation-delay: 0.6s;
}

.result-star.earned {
    color: var(--color-warning);
}

@keyframes starPop {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    50% {
        transform: scale(1.3);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.results-title {
    font-size: var(--font-size-3xl);
    margin-bottom: var(--space-2xl);
}

.results-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-md);
    width: 100%;
    margin-bottom: var(--space-xl);
}

.stat-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    padding: var(--space-lg) var(--space-sm);
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    border: 2px solid var(--color-bg-elevated);
    box-shadow: var(--shadow-sm);
}

.stat-item.highlight {
    background: #F0F4FC;
    border-color: var(--color-accent-primary);
}

.stat-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-secondary);
}

.stat-value {
    font-size: var(--font-size-xl);
    font-weight: 700;
}

.xp-gain {
    color: var(--color-accent-primary);
}

.streak-celebration {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-lg);
    background: #FFFAF0;
    border: 2px solid var(--color-warning);
    border-radius: var(--radius-full);
    margin-bottom: var(--space-xl);
    animation: fadeIn var(--transition-base);
    box-shadow: var(--shadow-sm);
}

.streak-fire {
    font-size: var(--font-size-xl);
    animation: fireGlow 1s infinite;
}

@keyframes fireGlow {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

.results-actions {
    display: flex;
    gap: var(--space-md);
    width: 100%;
    margin-bottom: var(--space-lg);
}

.results-actions .btn {
    flex: 1;
}

/* ================================
   Progress Screen
   ================================ */

.progress-content {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 120px;
    /* Room for fixed bottom nav + some breathing space */
}

.progress-hero {
    text-align: center;
    padding: var(--space-2xl) 0;
}

.total-xp-display {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.big-number {
    font-size: var(--font-size-5xl);
    font-weight: 800;
    color: var(--color-accent-primary);
}

.big-label {
    font-size: var(--font-size-lg);
    color: var(--color-text-secondary);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    margin-bottom: var(--space-2xl);
}

.stat-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-xl);
    background: #FFFFFF;
    border-radius: var(--radius-xl);
    border: 2px solid var(--color-bg-elevated);
    box-shadow: var(--shadow-sm);
}

.stat-icon {
    font-size: var(--font-size-2xl);
}

.stat-number {
    font-size: var(--font-size-2xl);
    font-weight: 800;
    color: var(--color-text-primary);
}

.stat-name {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    text-align: center;
}

.recent-activity h2 {
    font-size: var(--font-size-lg);
    margin-bottom: var(--space-lg);
}

.activity-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
}

.activity-item {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md);
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    border: 2px solid var(--color-bg-elevated);
}

.empty-state {
    text-align: center;
    padding: var(--space-2xl);
    color: var(--color-text-muted);
}

/* ================================
   Settings Screen
   ================================ */

.settings-content {
    flex: 1;
    overflow-y: auto;
}

.settings-section {
    margin-bottom: var(--space-2xl);
}

.settings-section-title {
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--space-md);
    padding-left: var(--space-sm);
}

.speed-control {
    display: flex;
    gap: var(--space-sm);
}

.speed-btn {
    padding: var(--space-sm) var(--space-md);
    background: #FFFFFF;
    border: 2px solid var(--color-bg-elevated);
    border-radius: var(--radius-md);
    color: var(--color-text-secondary);
    font-family: inherit;
    font-size: var(--font-size-sm);
    font-weight: 700;
    cursor: pointer;
    transition: all var(--transition-fast);
    box-shadow: 0 4px 0 var(--color-bg-elevated);
}

.speed-btn.active {
    border-color: var(--color-accent-primary);
    color: var(--color-accent-primary);
    box-shadow: 0 4px 0 var(--color-accent-primary);
    transform: translateY(-2px);
}

.about-info {
    padding: var(--space-lg);
    background: var(--color-bg-card);
    border-radius: var(--radius-lg);
    text-align: center;
}

.about-info p {
    margin-bottom: var(--space-sm);
}

.about-desc {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
}

/* ================================
   Achievement Popup
   ================================ */

.achievement-popup {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
}

.achievement-popup.hidden {
    display: none;
}

.achievement-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.85);
    animation: fadeIn var(--transition-fast);
}

.achievement-modal {
    position: relative;
    text-align: center;
    padding: var(--space-2xl);
    background: #FFFFFF;
    border: 4px solid var(--color-warning);
    border-radius: var(--radius-xl);
    max-width: 320px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    animation: achievementPop 0.5s ease;
}

@keyframes achievementPop {
    0% {
        transform: scale(0) rotate(-10deg);
        opacity: 0;
    }

    50% {
        transform: scale(1.1) rotate(2deg);
    }

    100% {
        transform: scale(1) rotate(0);
        opacity: 1;
    }
}

.achievement-badge {
    font-size: 72px;
    margin-bottom: var(--space-lg);
    animation: badgeBounce 0.5s ease 0.3s;
}

@keyframes badgeBounce {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.achievement-modal h2 {
    font-size: var(--font-size-lg);
    color: var(--color-warning);
    margin-bottom: var(--space-md);
}

.achievement-name {
    font-size: var(--font-size-2xl);
    font-weight: 700;
    margin-bottom: var(--space-sm);
}

.achievement-desc {
    color: var(--color-text-secondary);
    margin-bottom: var(--space-lg);
}

.achievement-xp {
    display: inline-block;
    padding: var(--space-sm) var(--space-lg);
    background: rgba(108, 99, 255, 0.2);
    border-radius: var(--radius-full);
    font-weight: 700;
    color: var(--color-accent-primary);
    margin-bottom: var(--space-xl);
}

/* ================================
   Navigation Bar (New Braillito Design)
   ================================ */

.main-nav-new {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    background: white;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    padding: 12px 24px;
    padding-bottom: calc(12px + env(safe-area-inset-bottom));
    z-index: 1000;
    border-radius: 24px 24px 0 0;
    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.03);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        opacity 0.3s ease;
}

.main-nav-new.hidden {
    transform: translateY(100%);
    opacity: 0;
    pointer-events: none;
}

.nav-container {
    max-width: 420px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px;
}

.nav-tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 4px;
    background: none;
    border: none;
    cursor: pointer;
    color: #9CA3AF;
    transition: color 0.2s ease;
}

.nav-tab.active {
    color: var(--color-primary-orange);
}

.nav-tab:hover {
    color: var(--color-text-primary);
}

.nav-tab-icon-wrap {
    padding: 6px 16px;
    border-radius: var(--radius-full);
    transition: background 0.2s ease;
}

.nav-tab-icon-wrap.active,
.nav-tab.active .nav-tab-icon-wrap {
    background: rgba(255, 144, 69, 0.12);
}

.nav-tab-icon {
    font-size: 1.5rem;
    display: block;
}

.nav-tab-label {
    font-size: 0.625rem;
    font-weight: 600;
}

.nav-tab.active .nav-tab-label {
    font-weight: 700;
}

/* High Contrast - Navigation */
.high-contrast .main-nav-new {
    background: #0D0D0D;
    border-top-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .nav-tab {
    color: #888888;
}

.high-contrast .nav-tab.active {
    color: var(--color-primary-orange);
}

.high-contrast .nav-tab:hover {
    color: #ffffff;
}

.high-contrast .nav-tab.active .nav-tab-icon-wrap {
    background: rgba(255, 144, 69, 0.2);
}

/* Keep old classes for backward compatibility */
.main-nav {
    position: fixed;
    bottom: 16px;
    left: 16px;
    right: 16px;
    width: auto;
    max-width: 420px;
    margin: 0 auto;
    height: 64px;
    background: #ffffff;
    border-radius: 20px;
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 0 8px;
    z-index: 1000;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        opacity 0.3s ease;
}

.main-nav.hidden {
    transform: translateY(100%);
    opacity: 0;
    pointer-events: none;
}

.nav-indicator {
    display: none;
}

.nav-item {
    flex: 1;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    background: none;
    border: none;
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    z-index: 1;
}

.nav-item.active {
    color: var(--color-primary-orange);
}

.nav-icon {
    font-size: 24px;
}

.nav-label {
    font-size: var(--font-size-xs);
    font-weight: 800;
}

/* ================================
   Practice Mode Setup
   ================================ */

.practice-setup-content {
    padding: var(--space-md);
    padding-bottom: 40px;
}

.setup-section {
    margin-bottom: var(--space-xl);
}

.setup-section-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: var(--space-md);
    color: var(--color-text-primary);
}

.game-type-options,
.letter-filter-options {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.game-type-option,
.letter-filter-option {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md);
    background: var(--color-surface-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-lg);
    cursor: pointer;
    text-align: left;
    transition: all var(--transition-base);
}

.game-type-option:hover,
.letter-filter-option:hover {
    background: rgba(255, 255, 255, 0.08);
}

.game-type-option.active,
.letter-filter-option.active {
    background: rgba(108, 99, 255, 0.15);
    border-color: var(--color-accent-primary);
    box-shadow: 0 4px 12px rgba(108, 99, 255, 0.2);
}

.type-icon,
.filter-icon {
    font-size: 1.5rem;
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
}

.game-type-option.active .type-icon,
.letter-filter-option.active .filter-icon {
    background: var(--color-accent-primary);
}

.type-info,
.filter-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.type-name,
.filter-name {
    font-weight: 700;
    font-size: 1rem;
    color: var(--color-text-primary);
}

.type-desc,
.filter-count {
    font-size: 0.85rem;
    color: var(--color-text-muted);
}

/* Custom Letter Picker */
.custom-letter-picker {
    margin-top: var(--space-md);
    padding: var(--space-md);
    background: rgba(0, 0, 0, 0.2);
    border-radius: var(--radius-lg);
}

.picker-label {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: var(--space-sm);
    color: var(--color-text-muted);
}

.letter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: var(--space-sm);
}

.letter-pick-node {
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-surface-secondary);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    font-weight: 700;
    font-size: 1.2rem;
    color: var(--color-text-muted);
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
}

.letter-pick-node.selected {
    background: var(--color-accent-primary);
    color: white;
    border-color: transparent;
}

.selection-indicator {
    position: absolute;
    top: -4px;
    right: -4px;
    width: 20px;
    height: 20px;
    background: var(--color-accent-secondary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-xs);
    opacity: 0;
    transform: scale(0.5);
    transition: all 0.2s ease;
}

.letter-pick-node.selected .selection-indicator {
    opacity: 1;
    transform: scale(1);
}

/* Round Selector */
.round-selector {
    display: flex;
    gap: var(--space-xs);
}

.round-option {
    flex: 1;
    padding: 10px;
    background: var(--color-surface-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
    transition: all var(--transition-base);
}

.round-option.active {
    background: var(--color-accent-primary);
    color: white;
}

.session-options {
    background: var(--color-surface-tertiary);
    border-radius: var(--radius-lg);
    padding: 4px;
}

.option-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-md);
}

.option-row:not(:last-child) {
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.option-info {
    display: flex;
    flex-direction: column;
}

/* Back buttons */
.back-btn {
    color: var(--color-text-primary);
}

/* Adjust screens for floating nav bar */
.screen {
    padding-bottom: 100px;
}

/* Screens that should NOT have nav padding */
#splash-screen,
#onboarding-screen,
#profile-screen,
#instruction-screen,
#game-build-screen,
#game-pick-screen {
    padding-bottom: var(--space-xl);
}

/* ================================
   Orbital's Lab & Companion
   ================================ */

.lab-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
    padding: var(--space-md);
    flex: 1;
}

.companion-viewport {
    height: 200px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    background: radial-gradient(circle at center, rgba(108, 99, 255, 0.15) 0%, transparent 70%);
}

/* ================================
   Puppy Mascot (Buddy)
   ================================ */

.puppy-mascot {
    position: relative;
    width: 120px;
    height: 120px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: puppyBob 4s ease-in-out infinite;
}

.puppy-svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.1));
}

.puppy-mascot.small {
    width: 80px;
    height: 80px;
}

.puppy-mascot.tiny {
    width: 60px;
    height: 60px;
}

/* Screen Specific Mascot Styling */
.puppy-instruction-container {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    margin-top: var(--space-xs);
    animation: puppyEnter 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Hide the original instruction text when Buddy is speaking */
#instruction-screen .instruction-text-container {
    display: none;
}

.puppy-instruction-container .instruction-bubble {
    margin: 0;
    max-width: 200px;
    order: 2;
}

.puppy-instruction-container .puppy-mascot {
    order: 1;
}

@keyframes puppyEnter {
    from {
        transform: translateY(30px) scale(0.8);
        opacity: 0;
    }

    to {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
}

.puppy-mascot-mini {
    margin-top: var(--space-md);
    display: flex;
    justify-content: center;
}

/* Animations */
@keyframes puppyBob {

    0%,
    100% {
        transform: translateY(0) rotate(0deg);
    }

    50% {
        transform: translateY(-10px) rotate(1deg);
    }
}

@keyframes puppyTailWag {

    0%,
    100% {
        transform: rotate(0deg);
    }

    50% {
        transform: rotate(15deg);
    }
}

@keyframes puppyEarWagL {

    0%,
    100% {
        transform: rotate(0deg);
    }

    50% {
        transform: rotate(-5deg);
    }
}

@keyframes puppyEarWagR {

    0%,
    100% {
        transform: rotate(0deg);
    }

    50% {
        transform: rotate(5deg);
    }
}

@keyframes puppyBlink {

    0%,
    90%,
    100% {
        transform: scaleY(1);
    }

    95% {
        transform: scaleY(0.1);
    }
}

.puppy-tail {
    transform-origin: bottom center;
    animation: puppyTailWag 0.8s ease-in-out infinite;
}

.puppy-ear-l {
    transform-origin: top right;
    animation: puppyEarWagL 2s ease-in-out infinite;
}

.puppy-ear-r {
    transform-origin: top left;
    animation: puppyEarWagR 2.2s ease-in-out infinite;
}

.puppy-paw-r {
    transform-origin: center top;
    animation: puppyPawWave 1.5s ease-in-out infinite;
}

@keyframes puppyPawWave {

    0%,
    100% {
        transform: rotate(0deg);
    }

    25% {
        transform: rotate(-10deg);
    }

    75% {
        transform: rotate(10deg);
    }
}

.puppy-tongue {
    animation: puppyPant 0.6s ease-in-out infinite alternate;
}

@keyframes puppyPant {
    0% {
        transform: scaleY(0.8);
    }

    100% {
        transform: scaleY(1);
    }
}

.puppy-eye {
    animation: puppyBlink 4s infinite;
}

.puppy-mascot.happy {
    animation: puppyHappy 0.5s ease-in-out infinite;
}

@keyframes puppyHappy {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1) translateY(-15px);
    }
}

/* Speech Bubble */
.puppy-bubble {
    position: relative;
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    padding: var(--space-md);
    margin-top: var(--space-md);
    box-shadow: var(--shadow-md);
    border: 2px solid var(--color-bg-elevated);
    max-width: 280px;
    animation: bubblePop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.puppy-bubble::after {
    content: '';
    position: absolute;
    top: 50%;
    left: -12px;
    transform: translateY(-50%);
    border-top: 10px solid transparent;
    border-bottom: 10px solid transparent;
    border-right: 12px solid #FFFFFF;
}

@keyframes bubblePop {
    0% {
        transform: scale(0.8);
        opacity: 0;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.puppy-bubble p {
    font-size: var(--font-size-base);
    font-weight: 600;
    color: var(--color-text-primary);
    line-height: 1.4;
    text-align: center;
}

.companion-bubble {
    margin-top: var(--space-md);
    padding: var(--space-sm) var(--space-md);
    background: var(--color-surface-secondary);
    border-radius: var(--radius-lg);
    border-bottom-left-radius: 4px;
    max-width: 80%;
    position: relative;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.companion-bubble p {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--color-text-primary);
}

/* Lab Interaction Area */
.lab-interaction-area {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
    background: var(--color-surface-tertiary);
    padding: var(--space-xl);
    border-radius: var(--radius-xl);
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.lab-cell-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
}

.lab-result {
    font-size: 3rem;
    font-weight: 800;
    color: var(--color-accent-secondary);
    text-shadow: 0 0 20px rgba(130, 255, 240, 0.5);
    height: 4.5rem;
    display: flex;
    align-items: center;
}

.lab-controls {
    display: flex;
    gap: var(--space-sm);
    flex-wrap: wrap;
}

.lab-controls .btn {
    flex: 1;
    min-width: 120px;
}

.btn-small {
    padding: var(--space-sm) var(--space-md);
    font-size: 0.85rem;
}

/* Unified Progress / Achievements */
.achievements-section {
    margin-top: var(--space-xl);
}

.achievements-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: var(--space-md);
    margin-top: var(--space-md);
}

.achievement-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: var(--space-md);
    background: #FFFFFF;
    border-radius: var(--radius-lg);
    border: 2px solid var(--color-bg-elevated);
    opacity: 0.5;
    transition: all var(--transition-base);
}

.achievement-card.earned {
    opacity: 1;
    background: #FFFFFF;
    border-color: var(--color-warning);
    box-shadow: 0 6px 0 var(--color-warning);
    transform: translateY(-2px);
}

.achievement-icon {
    font-size: 2rem;
    margin-bottom: 4px;
}

.achievement-name {
    font-size: var(--font-size-xs);
    font-weight: 700;
    line-height: 1.2;
}

/* DASHBOARD HIGHLIGHT */
.nav-card.highlight {
    background: linear-gradient(135deg, rgba(108, 99, 255, 0.2) 0%, rgba(130, 255, 240, 0.1) 100%);
    border: 1px solid var(--color-accent-primary);
}

.nav-card.highlight .nav-icon {
    animation: pulseIcon 2s infinite;
}

@keyframes pulseIcon {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }
}

/* Responsive Adjustments */

@media (max-width: 380px) {
    :root {
        --space-lg: 1.25rem;
        --space-xl: 1.5rem;
        --font-size-4xl: 2rem;
        --font-size-5xl: 2.5rem;
    }

    .dot-btn {
        width: 60px;
        height: 60px;
    }

    .braille-cell.interactive {
        gap: 16px;
        padding: var(--space-xl);
    }
}

@media (min-width: 600px) {
    .app-container {
        border-left: 1px solid var(--color-bg-card);
        border-right: 1px solid var(--color-bg-card);
    }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ================================
   Install Gate (PWA)
   ================================ */

.install-gate-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-color);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
    box-sizing: border-box;
}

.install-card {
    background: white;
    padding: 40px 32px;
    border-radius: 32px;
    width: 100%;
    max-width: 440px;
    text-align: center;
    box-shadow: 0 20px 50px rgba(99, 102, 241, 0.15);
    animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
}

.install-icon {
    width: 120px;
    height: 120px;
    margin: 0 auto 24px;
}

.install-card h1 {
    font-size: 1.75rem;
    font-weight: 800;
    color: var(--text-color);
    margin: 0 0 16px;
    line-height: 1.2;
}

.install-card p {
    color: var(--text-light);
    font-size: 1.1rem;
    line-height: 1.6;
    margin: 0 0 32px;
}

.install-platform {
    display: flex;
    flex-direction: column;
    gap: 16px;
    animation: fadeIn 0.4s ease-out;
}

/* iOS Instructions */
.ios-instructions {
    text-align: left;
    background: #f8f9ff;
    padding: 24px;
    border-radius: 20px;
    margin-bottom: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.step {
    display: flex;
    align-items: center;
    gap: 16px;
}

.step-num {
    background: var(--primary-color);
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.9rem;
    flex-shrink: 0;
}

.step p {
    font-size: 0.95rem;
    margin: 0;
    color: var(--text-color);
    line-height: 1.4;
}

.ios-icon {
    width: 24px;
    height: 24px;
    background-size: contain;
    background-repeat: no-repeat;
    flex-shrink: 0;
}

.ios-icon.share {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236366f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8'/%3E%3Cpolyline points='16 6 12 2 8 6'/%3E%3Cline x1='12' y1='2' x2='12' y2='15'/%3E%3C/svg%3E");
}

.ios-icon.add {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236366f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'/%3E%3Cline x1='12' y1='8' x2='12' y2='16'/%3E%3Cline x1='8' y1='12' x2='16' y2='12'/%3E%3C/svg%3E");
}

.final-msg {
    margin-top: 16px;
    padding: 12px;
    background: #ecfdf5;
    color: #059669;
    border-radius: 12px;
    font-size: 0.95rem;
    font-weight: 500;
}

.hidden {
    display: none !important;
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Benefits list styles */
.install-benefits {
    list-style: none;
    padding: 0;
    margin: 0 0 32px;
    text-align: left;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.install-benefits li {
    font-size: 0.95rem;
    color: var(--text-color);
    display: flex;
    align-items: flex-start;
    gap: 10px;
    line-height: 1.4;
}

.install-benefits li strong {
    color: var(--primary-color);
}

.install-bypass {
    margin-top: 32px;
    border-top: 1px solid #eee;
    padding-top: 24px;
}

.text-btn {
    background: none;
    border: none;
    color: var(--text-light);
    font-size: 0.9rem;
    font-weight: 600;
    text-decoration: underline;
    cursor: pointer;
    transition: color 0.2s;
}

.text-btn:hover {
    color: var(--primary-color);
}

/* ================================
   Install Banner (PWA - NEW)
   ================================ */

.install-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 16px 20px;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    animation: slideUpBanner 0.4s ease-out;
    border-radius: 20px 20px 0 0;
}

.install-banner p {
    margin: 0;
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-color);
}

.install-banner-actions {
    display: flex;
    gap: 12px;
}

.banner-btn {
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    border: none;
    transition: transform 0.2s, opacity 0.2s;
}

.banner-btn:active {
    transform: scale(0.96);
}

.banner-btn.primary {
    background: var(--primary-color);
    color: white;
}

.banner-btn.secondary {
    background: #f0f0f5;
    color: var(--text-light);
}

.ios-hint {
    font-size: 0.85rem;
    color: var(--text-light);
    text-align: center;
}

.ios-hint strong {
    color: var(--primary-color);
}

@keyframes slideUpBanner {
    from {
        transform: translateY(100%);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* ================================
   New Settings Screen Styles
   ================================ */

.settings-new {
    background: var(--color-bg-primary);
    padding: 0 !important;
    overflow-y: auto;
}

.settings-header-new {
    position: sticky;
    top: 0;
    z-index: 40;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    padding-top: calc(16px + env(safe-area-inset-top));
    background: var(--color-bg-primary);
}

.settings-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
}

.settings-header-left h1 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
}

.settings-back-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #ffffff;
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.2s;
}

.settings-back-btn:active {
    transform: scale(0.95);
}

.braille-dots-mini {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 3px;
    opacity: 0.5;
}

.braille-dots-mini span {
    width: 6px;
    height: 6px;
    background: var(--color-text-primary);
    border-radius: 50%;
}

.braille-dots-mini span.orange {
    background: var(--color-primary-orange);
}

.settings-content-new {
    padding: 0 24px 120px;
    display: flex;
    flex-direction: column;
    gap: 24px;
}

/* Profile Card */
.profile-card-new {
    background: #ffffff;
    border-radius: 2rem;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    gap: 16px;
    position: relative;
    overflow: hidden;
}

.profile-avatar-new {
    width: 64px;
    height: 64px;
    min-width: 64px;
    border-radius: 50%;
    background: var(--color-primary-orange);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #0e1b13;
    font-weight: 700;
    font-size: 1.25rem;
    box-shadow: 0 4px 12px rgba(255, 144, 69, 0.3);
    border: 2px solid #ffffff;
}

.profile-info-new {
    flex: 1;
}

.profile-info-new h2 {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0;
}

.profile-email {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    margin: 4px 0;
}

.profile-edit-btn {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-primary-orange);
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}

.profile-edit-btn .material-symbols-outlined {
    font-size: 14px;
}

.profile-card-accent {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 96px;
    background: linear-gradient(to left, rgba(255, 144, 69, 0.05), transparent);
}

/* Settings Sections */
.settings-section-new {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.settings-section-title-new {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 0 8px;
}

.settings-card-new {
    background: #ffffff;
    border-radius: 2rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    border: 1px solid rgba(0, 0, 0, 0.05);
    overflow: hidden;
}

.settings-row-new {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px;
    width: 100%;
    background: none;
    border: none;
    cursor: pointer;
    transition: background 0.2s;
    text-align: left;
}

.settings-row-new:hover {
    background: rgba(0, 0, 0, 0.02);
}

.settings-row-left {
    display: flex;
    align-items: center;
    gap: 12px;
}

.settings-row-right {
    display: flex;
    align-items: center;
    gap: 8px;
}

.settings-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.settings-icon .material-symbols-outlined {
    font-size: 20px;
}

.settings-icon.blue {
    background: #eff6ff;
    color: #3b82f6;
}

.settings-icon.purple {
    background: #f5f3ff;
    color: #8b5cf6;
}

.settings-icon.orange {
    background: #fff7ed;
    color: #f97316;
}

.settings-icon.green {
    background: #f0fdf4;
    color: #22c55e;
}

.settings-icon.teal {
    background: #f0fdfa;
    color: #14b8a6;
}

.settings-icon.indigo {
    background: #eef2ff;
    color: #6366f1;
}

.settings-icon.rose {
    background: #fff1f2;
    color: #f43f5e;
}

.settings-icon.slate {
    background: #f1f5f9;
    color: #475569;
}

.settings-icon.amber {
    background: #fffbeb;
    color: #f59e0b;
}

.settings-icon.cyan {
    background: #ecfeff;
    color: #06b6d4;
}

.settings-label {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-text-primary);
}

.settings-label-group {
    display: flex;
    flex-direction: column;
    text-align: left;
}

.settings-sublabel {
    font-size: 0.625rem;
    color: var(--color-text-muted);
}

.settings-value {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--color-text-muted);
}

.settings-divider {
    height: 1px;
    background: rgba(0, 0, 0, 0.05);
    margin: 0 16px;
}

.chevron {
    color: #9ca3af;
    transition: transform 0.2s;
}

.settings-row-new:hover .chevron {
    transform: translateX(4px);
}

/* New Toggle Switch */
.toggle-switch-new {
    position: relative;
    width: 48px;
    height: 24px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}

.toggle-track-new {
    display: block;
    width: 100%;
    height: 100%;
    background: #d1d5db;
    border-radius: 12px;
    transition: background 0.3s;
    position: relative;
}

.toggle-thumb-new {
    position: absolute;
    top: 0;
    left: 0;
    width: 24px;
    height: 24px;
    background: #ffffff;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    border: 4px solid #d1d5db;
    transition: all 0.3s;
}

.toggle-switch-new.on .toggle-track-new {
    background: var(--color-primary-orange);
}

.toggle-switch-new.on .toggle-thumb-new {
    left: 24px;
    border-color: var(--color-primary-orange);
}

/* Speed Control */
.speed-control-new {
    display: flex;
    background: #f3f4f6;
    border-radius: 8px;
    padding: 4px;
    gap: 4px;
}

.speed-btn-new {
    padding: 6px 12px;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 6px;
    background: none;
    border: none;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.2s;
}

.speed-btn-new.active {
    background: #ffffff;
    color: #3b82f6;
    font-weight: 700;
    border: 1px solid #3b82f6;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Bottom Section */
.settings-bottom-new {
    display: flex;
    align-items: flex-end;
    gap: 16px;
    padding-top: 16px;
}

.settings-mascot-container {
    position: relative;
    width: 96px;
    height: 96px;
}

.settings-mascot-bubble {
    position: absolute;
    top: -24px;
    right: -40px;
    background: #ffffff;
    padding: 8px 12px;
    border-radius: 12px 12px 12px 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.05);
    transform: rotate(6deg);
    z-index: 1;
}

.settings-mascot-bubble p {
    font-size: 0.625rem;
    font-weight: 700;
    color: var(--color-primary-orange);
    white-space: nowrap;
    margin: 0;
}

.settings-mascot {
    width: 100%;
    height: 100%;
}

.settings-mascot svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
}

.logout-btn-new {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 16px;
    background: #fef2f2;
    color: #ef4444;
    border: 1px solid #fee2e2;
    border-radius: 1rem;
    font-size: 0.875rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
}

.logout-btn-new:hover {
    background: #fee2e2;
}

.logout-btn-new:active {
    transform: scale(0.98);
}

.settings-version {
    text-align: center;
    font-size: 0.625rem;
    color: var(--color-text-muted);
    opacity: 0.5;
    padding: 16px 0;
}

/* High Contrast Mode */
.high-contrast .settings-new {
    background: #000000;
}

.high-contrast .settings-header-new {
    background: #000000;
}

.high-contrast .settings-back-btn {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.2);
}

.high-contrast .profile-card-new,
.high-contrast .settings-card-new {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .settings-divider {
    background: rgba(255, 255, 255, 0.1);
}

.high-contrast .toggle-track-new {
    background: #333;
}

.high-contrast .speed-control-new {
    background: #222;
}

.high-contrast .speed-btn-new.active {
    background: #333;
    border-color: var(--color-primary-orange);
    color: var(--color-primary-orange);
}

.high-contrast .logout-btn-new {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.2);
}

/* ================================
   New Lesson Intro Screen Styles
   ================================ */

.lesson-intro-new {
    background: var(--color-bg-primary);
    padding: 0 !important;
    display: flex;
    flex-direction: column;
}

.lesson-intro-header-new {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    padding-top: calc(16px + env(safe-area-inset-top));
    background: transparent;
}

.lesson-intro-header-new h1 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-text-primary);
    text-align: center;
    flex: 1;
}

.intro-back-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #ffffff;
    border: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.intro-back-btn:hover {
    background: #f8f9fa;
}

.intro-back-btn:active {
    transform: scale(0.95);
}

.intro-back-btn .material-symbols-outlined {
    font-size: 20px;
    color: var(--color-text-primary);
}

.lesson-intro-content-new {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    text-align: center;
}

/* Braille Cell Card */
.braille-cell-card {
    background: #ffffff;
    border-radius: 24px;
    padding: 32px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
    margin-bottom: 32px;
}

.braille-cell-card .braille-demo-cell.large {
    transform: scale(1.2);
}

.lesson-title-new {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 16px;
}

.lesson-desc-new {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--color-text-muted);
    max-width: 320px;
    margin-bottom: 32px;
}

/* Orange Primary Button */
.btn-orange-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    max-width: 320px;
    padding: 18px 32px;
    background: var(--color-primary-orange);
    color: #0e1b13;
    border: none;
    border-radius: 9999px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.35);
}

.btn-orange-primary:hover {
    background: #ff8533;
    transform: translateY(-2px);
    box-shadow: 0 12px 32px rgba(255, 144, 69, 0.4);
}

.btn-orange-primary:active {
    transform: scale(0.98) translateY(0);
}

.btn-orange-primary .material-symbols-outlined {
    font-size: 20px;
    transition: transform 0.2s;
}

.btn-orange-primary:hover .material-symbols-outlined {
    transform: translateX(4px);
}

/* High Contrast */
.high-contrast .lesson-intro-new {
    background: #000000;
}

.high-contrast .intro-back-btn {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.2);
}

.high-contrast .braille-cell-card {
    background: #141414;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* ================================
   New Pre-Lesson Screen Styles
   ================================ */

.pre-lesson-screen {
    /* Default: hidden like other screens */
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    z-index: 100;
    background: linear-gradient(180deg, rgba(255, 144, 69, 0.05) 0%, var(--color-bg-primary) 50%);
    padding: 0 !important;
    flex-direction: column;
    overflow: hidden;
}

/* Only show when active */
.pre-lesson-screen.active {
    display: flex;
}

/* Header */
.pre-lesson-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 40;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px;
    padding-top: calc(16px + env(safe-area-inset-top));
    max-width: 448px;
    margin: 0 auto;
}

.pre-lesson-back-btn {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(12px);
    border-radius: 50%;
    border: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.pre-lesson-back-btn:hover {
    background: #ffffff;
}

.pre-lesson-back-btn:active {
    transform: scale(0.95);
}

.pre-lesson-back-btn .material-symbols-outlined {
    font-size: 20px;
    color: var(--color-text-primary);
}

.pre-lesson-unit-badge {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.6;
}

/* Mascot Area */
.pre-lesson-mascot-area {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding-top: 50px;
    padding-bottom: 16px;
}

.pre-lesson-mascot-container {
    position: relative;
    animation: mascotFloat 6s ease-in-out infinite;
}

@keyframes mascotFloat {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.mascot-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120px;
    height: 120px;
    background: rgba(255, 144, 69, 0.2);
    border-radius: 50%;
    filter: blur(32px);
}

.mascot-speech-bubble {
    position: absolute;
    top: -24px;
    right: -32px;
    background: #ffffff;
    padding: 4px 10px;
    border-radius: 10px 10px 10px 0;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
    z-index: 20;
    animation: bubbleBounce 3s infinite;
}

@keyframes bubbleBounce {

    0%,
    100% {
        transform: scale(1) rotate(0);
    }

    50% {
        transform: scale(1.05) rotate(-2deg);
    }
}

.mascot-speech-bubble span {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-primary-orange);
}

.pre-lesson-mascot-figure {
    position: relative;
    z-index: 10;
    width: 100px;
    height: 100px;
    animation: mascotFloat 3s ease-in-out infinite;
}

.pre-lesson-pet-svg {
    width: 100%;
    height: 100%;
}

.pre-lesson-pet-svg .antenna-ball-pulse {
    animation: antennaBallPulse 1.5s ease-in-out infinite;
}

.mascot-robot-body {
    width: 128px;
    height: 112px;
    background: #ffffff;
    border-radius: 2rem;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border: 4px solid #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

.mascot-robot-screen {
    width: 80px;
    height: 56px;
    background: #1a2e22;
    border-radius: 12px;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px;
    box-shadow: inset 0 4px 12px rgba(0, 0, 0, 0.3);
    position: relative;
}

.mascot-robot-eye {
    width: 8px;
    height: 20px;
    background: var(--color-primary-orange);
    border-radius: 9999px;
    animation: eyePulse 2s infinite;
}

@keyframes eyePulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.6;
    }
}

.mascot-robot-mouth {
    position: absolute;
    bottom: 12px;
    width: 24px;
    height: 12px;
    border-bottom: 2px solid rgba(255, 144, 69, 0.5);
    border-radius: 0 0 50% 50%;
}

.mascot-antenna {
    position: absolute;
    top: -16px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 24px;
    background: #d1d5db;
}

.mascot-antenna-ball {
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 12px;
    height: 12px;
    background: var(--color-primary-orange);
    border-radius: 50%;
    box-shadow: 0 0 12px rgba(255, 144, 69, 0.4);
    animation: antennaPulse 2s infinite;
}

@keyframes antennaPulse {

    0%,
    100% {
        box-shadow: 0 0 12px rgba(255, 144, 69, 0.4);
    }

    50% {
        box-shadow: 0 0 24px rgba(255, 144, 69, 0.8);
    }
}

.mascot-arm {
    position: absolute;
    width: 16px;
    height: 40px;
    background: #ffffff;
    border: 2px solid #ffffff;
    border-radius: 9999px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.mascot-arm-left {
    top: 48px;
    left: -12px;
    transform: rotate(-12deg);
}

.mascot-arm-right {
    top: 32px;
    right: -16px;
    transform: rotate(30deg);
    height: 48px;
    transform-origin: bottom;
}

/* Bottom Sheet */
.pre-lesson-sheet {
    flex: 1;
    background: #ffffff;
    border-radius: 2rem 2rem 0 0;
    box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.05);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    padding: 20px 24px;
    padding-bottom: calc(20px + env(safe-area-inset-bottom));
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow-y: auto;
}

.sheet-handle {
    position: absolute;
    top: 16px;
    left: 50%;
    transform: translateX(-50%);
    width: 48px;
    height: 4px;
    background: #e5e7eb;
    border-radius: 9999px;
}

.sheet-content {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 4px;
}

.lesson-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(255, 144, 69, 0.1);
    color: var(--color-primary-orange);
    padding: 6px 12px;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    width: fit-content;
}

.lesson-badge .material-symbols-outlined {
    font-size: 14px;
}

.pre-lesson-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    line-height: 1.2;
    margin: 0;
}

.lesson-time {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--color-text-muted);
    font-size: 0.875rem;
    font-weight: 500;
}

.lesson-time .material-symbols-outlined {
    font-size: 18px;
}

.sheet-divider {
    border: none;
    border-top: 1px solid #f3f4f6;
    margin: 8px 0;
}

.pre-lesson-desc {
    font-size: 0.875rem;
    line-height: 1.6;
    color: var(--color-text-muted);
    margin: 0;
}

/* Tip Card */
.lesson-tip-card {
    display: flex;
    gap: 10px;
    background: var(--color-bg-primary);
    border-radius: 10px;
    padding: 12px;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.tip-icon {
    width: 32px;
    height: 32px;
    min-width: 32px;
    background: #ffffff;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.tip-icon .material-symbols-outlined {
    font-size: 16px;
    color: var(--color-primary-orange);
}

.tip-content {
    flex: 1;
}

.tip-content strong {
    display: block;
    font-size: 0.8125rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 4px;
}

.tip-content p {
    font-size: 0.75rem;
    color: var(--color-text-muted);
    margin: 0;
    line-height: 1.4;
}

/* Start Button */
.pre-lesson-start-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 18px 32px;
    background: var(--color-primary-orange);
    color: #0e1b13;
    border: none;
    border-radius: 1rem;
    font-size: 1.125rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.3);
    margin-top: auto;
    position: relative;
    overflow: hidden;
}

.pre-lesson-start-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(100%);
    transition: transform 0.3s;
    border-radius: 1rem;
}

.pre-lesson-start-btn:hover::before {
    transform: translateY(0);
}

.pre-lesson-start-btn:hover {
    background: #ff8533;
    transform: translateY(-2px);
    box-shadow: 0 12px 32px rgba(255, 144, 69, 0.4);
}

.pre-lesson-start-btn:active {
    transform: scale(0.98);
}

.pre-lesson-start-btn .material-symbols-outlined {
    font-size: 20px;
    transition: transform 0.2s;
}

.pre-lesson-start-btn:hover .material-symbols-outlined {
    transform: translateX(4px);
}

/* High Contrast */
.high-contrast .pre-lesson-screen {
    background: #000000;
}

.high-contrast .pre-lesson-back-btn {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.2);
}

.high-contrast .mascot-robot-body {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .pre-lesson-sheet {
    background: #0a0a0a;
    border-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .lesson-tip-card {
    background: #141414;
    border-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .tip-icon {
    background: #1a1a1a;
}

/* ================================
   NEW LESSON SCREEN DESIGN
   ================================ */

.lesson-screen-new {
    display: none;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
    padding: 0 !important;
    background-color: var(--color-bg-primary);
    position: relative;
}

.lesson-screen-new::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(#ff9045 15%, transparent 15%),
        radial-gradient(#ff9045 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.03;
    pointer-events: none;
    z-index: 0;
}

/* Decorative blur orb */
.lesson-screen-new::after {
    content: '';
    position: absolute;
    top: -80px;
    right: -80px;
    width: 256px;
    height: 256px;
    background: rgba(255, 144, 69, 0.1);
    border-radius: 50%;
    filter: blur(48px);
    pointer-events: none;
    z-index: 0;
}

.lesson-screen-new.active {
    display: flex;
}

/* Lesson Header */
.lesson-header-new {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 24px 24px 16px;
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
}

.lesson-close-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    border: none;
    background: transparent;
    color: rgba(14, 27, 19, 0.4);
    cursor: pointer;
    transition: all 0.2s ease;
    margin-left: -8px;
}

.lesson-close-btn:hover {
    background: rgba(0, 0, 0, 0.05);
    color: rgba(14, 27, 19, 0.6);
}

.lesson-close-btn .material-symbols-outlined {
    font-size: 24px;
    font-weight: 600;
}

/* Progress Bar */
.lesson-progress-bar-container {
    flex: 1;
    height: 16px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 9999px;
    overflow: hidden;
    position: relative;
}

.lesson-progress-bar-fill {
    height: 100%;
    background: var(--color-primary-orange);
    border-radius: 9999px;
    transition: width 0.5s ease-out;
    position: relative;
}

.lesson-progress-shine {
    position: absolute;
    top: 4px;
    right: 8px;
    width: 16px;
    height: 6px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 9999px;
}

/* Lives */
.lesson-lives {
    display: flex;
    align-items: center;
    gap: 6px;
}

.lesson-heart-icon {
    font-size: 24px;
    color: #ef4444;
    font-variation-settings: 'FILL' 1;
}

.lesson-lives-count {
    font-size: 18px;
    font-weight: 700;
    color: #ef4444;
}

/* Main Content */
.lesson-main-content {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
    padding: 0 24px 24px;
    overflow: hidden;
}

.lesson-phase-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 32px 0;
}

.lesson-content-area {
    display: flex;
    flex-direction: column;
    gap: 24px;
    flex: 1;
    justify-content: center;
}

/* Mascot Row */
.lesson-mascot-row {
    display: flex;
    align-items: flex-end;
    gap: 12px;
    width: 100%;
}

.lesson-mascot-mini {
    width: 96px;
    height: 96px;
    flex-shrink: 0;
    position: relative;
    z-index: 10;
}

@media (min-width: 640px) {
    .lesson-mascot-mini {
        width: 112px;
        height: 112px;
    }
}

.lesson-pet-svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
}

/* Speech Bubble */
.lesson-speech-bubble {
    position: relative;
    background: white;
    border: 2px solid #e5e7eb;
    padding: 12px 16px;
    border-radius: 16px 16px 16px 0;
    margin-bottom: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.lesson-speech-bubble p {
    margin: 0;
    font-size: 1rem;
    font-weight: 500;
    color: var(--color-text-primary);
}

.lesson-letter-highlight {
    color: var(--color-primary-orange);
    font-weight: 700;
}

.lesson-bubble-tail {
    position: absolute;
    left: -9px;
    bottom: 0;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-bottom: 15px solid #e5e7eb;
}

.lesson-bubble-tail::after {
    content: '';
    position: absolute;
    left: -6px;
    bottom: -13px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-bottom: 12px solid white;
}

/* Letter Display */
.lesson-letter-display {
    display: flex;
    justify-content: center;
    margin: 4px 0;
}

.lesson-letter-circle {
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border-radius: 50%;
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text-primary);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    border: 2px solid rgba(0, 0, 0, 0.05);
}

/* Braille Container */
.lesson-braille-container {
    display: flex;
    justify-content: center;
    padding: 8px;
}

.lesson-cell-new {
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 24px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    padding: 20px;
}

/* Glowing active dot */
.lesson-dot.active {
    background: var(--color-primary-orange) !important;
    color: white !important;
    box-shadow: 0 0 20px 4px rgba(255, 144, 69, 0.5), inset 0 0 12px rgba(255, 144, 69, 0.3);
    border-color: rgba(255, 144, 69, 0.4) !important;
}

/* Instruction Text */
.lesson-instruction-text {
    text-align: center;
    padding: 0 16px;
}

.lesson-instruction-text p {
    margin: 0;
    font-size: 1rem;
    color: var(--color-text-muted);
    font-weight: 500;
}

/* Progress Dots */
.lesson-progress-dots {
    display: flex;
    justify-content: center;
    padding: 16px 0;
}

.progress-dots-new {
    display: flex;
    align-items: center;
    gap: 8px;
}

.progress-dots-new .dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #d1d5db;
    transition: all 0.3s ease;
}

.progress-dots-new .dot.active {
    background: var(--color-primary-orange);
    width: 24px;
    border-radius: 5px;
}

.progress-dots-new .dot.completed {
    background: #22c55e;
}

/* Footer */
.lesson-footer-new {
    position: relative;
    z-index: 10;
    display: flex;
    gap: 16px;
    padding: 24px;
    padding-bottom: calc(24px + env(safe-area-inset-bottom));
    background: white;
    border-top: 1px solid rgba(14, 27, 19, 0.05);
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
}

.lesson-btn-secondary {
    flex: 1;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #e5e7eb;
    border: none;
    border-radius: 16px;
    font-size: 1rem;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.lesson-btn-secondary:hover {
    background: #d1d5db;
}

.lesson-btn-secondary:active {
    transform: scale(0.98);
}

.lesson-btn-primary {
    flex: 1;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-primary-orange);
    border: none;
    border-radius: 16px;
    font-size: 1rem;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.25);
}

.lesson-btn-primary:hover {
    background: rgba(255, 144, 69, 0.9);
}

.lesson-btn-primary:active {
    transform: scale(0.98);
}

/* High Contrast - Lesson Screen */
.high-contrast .lesson-screen-new {
    background: #000;
}

.high-contrast .lesson-close-btn {
    color: rgba(255, 255, 255, 0.6);
}

.high-contrast .lesson-progress-bar-container {
    background: rgba(255, 255, 255, 0.2);
}

.high-contrast .lesson-phase-title {
    color: #fff;
}

.high-contrast .lesson-speech-bubble {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .lesson-speech-bubble p {
    color: #fff;
}

.high-contrast .lesson-letter-circle {
    background: #1a1a1a;
    color: #fff;
    border-color: #333;
}

.high-contrast .lesson-cell-new {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .lesson-instruction-text p {
    color: rgba(255, 255, 255, 0.7);
}

.high-contrast .lesson-footer-new {
    background: #0a0a0a;
    border-color: rgba(255, 255, 255, 0.1);
}

.high-contrast .lesson-btn-secondary {
    background: #333;
    color: #fff;
}

/* ================================
   NEW BRAILLE LESSON CELL DESIGN
   ================================ */

.lesson-braille-cell-single {
    display: flex;
    justify-content: center;
    gap: 16px;
}

.braille-lesson-cell {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px 32px;
    padding: 24px 32px;
    background: white;
    border-radius: 24px;
    border: 2px solid #e5e7eb;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
}

.braille-lesson-dot {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: #d1d5db;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    /* Display numbers */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 600;
    color: #64748B;
    /* Light gray for numbers */
}

.braille-lesson-dot:active {
    transform: scale(0.95);
}

/* Active/Filled dot with glow effect */
.braille-lesson-dot.filled,
.braille-lesson-dot.active,
.braille-lesson-dot.animating,
.braille-lesson-dot[aria-checked="true"] {
    background: var(--color-primary-orange);
    color: white;
    /* White text when active */
    box-shadow: 0 0 20px 4px rgba(255, 144, 69, 0.5),
        inset 0 0 12px rgba(255, 144, 69, 0.3);
    border-color: rgba(255, 144, 69, 0.4);
}

/* High contrast mode */
.high-contrast .braille-lesson-cell {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .braille-lesson-dot {
    background: #444;
}

.high-contrast .braille-lesson-dot.filled,
.high-contrast .braille-lesson-dot.active,
.high-contrast .braille-lesson-dot.animating {
    background: var(--color-primary-orange);
}

/* ================================
   GAMES SCREEN STYLES
   ================================ */

.games-screen-new {
    display: none;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
    padding: 0 !important;
    background-color: var(--color-bg-primary);
    position: relative;
    overflow-y: auto;
}

.games-screen-new.active {
    display: flex;
}

.games-bg-pattern {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(#ff9045 15%, transparent 15%),
        radial-gradient(#ff9045 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.03;
    pointer-events: none;
    z-index: 0;
}

.games-glow {
    position: absolute;
    top: -80px;
    right: -80px;
    width: 256px;
    height: 256px;
    background: rgba(255, 144, 69, 0.1);
    border-radius: 50%;
    filter: blur(48px);
    pointer-events: none;
    z-index: 0;
}

.games-main-content {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
    padding: 24px;
    padding-bottom: calc(100px + env(safe-area-inset-bottom));
}

.games-mascot-row {
    display: flex;
    align-items: flex-end;
    gap: 12px;
    margin-bottom: 16px;
}

.games-mascot-container {
    width: 96px;
    height: 96px;
    flex-shrink: 0;
    border-radius: 50%;
    border: 2px solid white;
    background: #ffedd5;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.games-pet-svg {
    width: 100%;
    height: 100%;
    padding: 12px;
}

.games-speech-bubble {
    position: relative;
    background: white;
    border: 2px solid #e5e7eb;
    padding: 12px 16px;
    border-radius: 16px 16px 16px 0;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    flex: 1;
}

.games-speech-bubble p {
    margin: 0;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-primary);
}

.games-bubble-tail {
    position: absolute;
    left: -9px;
    bottom: 0;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-bottom: 15px solid #e5e7eb;
}

.games-bubble-tail::after {
    content: '';
    position: absolute;
    left: -6px;
    bottom: -13px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-bottom: 12px solid white;
}

.games-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 20px 0;
}

.games-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

/* Game Card */
.game-card {
    position: relative;
    background: white;
    border-radius: 24px;
    padding: 4px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    border: 1px solid transparent;
    transition: all 0.3s ease;
    overflow: hidden;
}

.game-card:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    border-color: rgba(255, 144, 69, 0.2);
}

.game-card-glow {
    position: absolute;
    top: 0;
    right: 0;
    width: 128px;
    height: 128px;
    border-radius: 50%;
    transform: translate(50%, -50%);
    z-index: 0;
}

.game-card-glow-orange {
    background: rgba(255, 144, 69, 0.1);
}

.game-card-glow-blue {
    background: rgba(59, 130, 246, 0.1);
}

.game-card-glow-purple {
    background: rgba(147, 51, 234, 0.1);
}

.game-card-content {
    position: relative;
    z-index: 10;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.game-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.game-icon {
    width: 56px;
    height: 56px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.game-icon .material-symbols-outlined {
    font-size: 28px;
}

.game-icon-orange {
    background: rgba(255, 237, 213, 1);
    color: var(--color-primary-orange);
}

.game-icon-blue {
    background: rgba(219, 234, 254, 1);
    color: #3b82f6;
}

.game-icon-purple {
    background: rgba(243, 232, 255, 1);
    color: #9333ea;
}

.game-difficulty {
    padding: 6px 10px;
    border-radius: 8px;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.game-difficulty-easy {
    background: rgba(220, 252, 231, 1);
    color: #15803d;
}

.game-difficulty-medium {
    background: rgba(254, 249, 195, 1);
    color: #a16207;
}

.game-difficulty-hard {
    background: rgba(254, 226, 226, 1);
    color: #dc2626;
}

.game-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.game-name {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0;
}

.game-desc {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin: 0;
    line-height: 1.4;
}

.game-play-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: none;
    font-size: 0.875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.game-play-btn .material-symbols-outlined {
    font-size: 20px;
}

.game-play-btn:active {
    transform: scale(0.98);
}

.game-play-btn-primary {
    background: var(--color-primary-orange);
    color: var(--color-text-primary);
    box-shadow: 0 4px 16px rgba(255, 144, 69, 0.25);
}

.game-play-btn-primary:hover {
    background: rgba(255, 144, 69, 0.9);
}

.game-play-btn-secondary {
    background: #e5e7eb;
    color: var(--color-text-primary);
}

.game-play-btn-secondary:hover {
    background: #d1d5db;
}

/* High Contrast - Games Screen */
.high-contrast .games-screen-new {
    background: #000;
}

.high-contrast .games-mascot-container {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .games-speech-bubble {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .games-speech-bubble p {
    color: #fff;
}

.high-contrast .games-title {
    color: #fff;
}

.high-contrast .game-card {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .game-name {
    color: #fff;
}

.high-contrast .game-desc {
    color: rgba(255, 255, 255, 0.7);
}

.high-contrast .game-play-btn-secondary {
    background: #333;
    color: #fff;
}

/* ================================
   INSTALL MODAL POPUP STYLES
   ================================ */

@keyframes installSlideUp {
    from {
        transform: translateY(100%);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.install-modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding: 16px;
    padding-bottom: 24px;
}

@media (min-width: 640px) {
    .install-modal-overlay {
        align-items: center;
        padding: 24px;
    }
}

.install-modal-overlay.hidden {
    display: none;
}

.install-modal-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}

.install-modal-card {
    position: relative;
    width: 100%;
    max-width: 384px;
    background: white;
    border-radius: 32px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    animation: installSlideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.install-modal-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 128px;
    background: rgba(255, 144, 69, 0.1);
    border-radius: 32px 32px 0 0;
}

.install-modal-glow {
    position: absolute;
    top: -40px;
    right: -40px;
    width: 160px;
    height: 160px;
    background: rgba(255, 144, 69, 0.2);
    border-radius: 50%;
    filter: blur(48px);
}

.install-modal-content {
    position: relative;
    padding: 24px;
    padding-top: 32px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.install-modal-mascot {
    position: relative;
    width: 128px;
    height: 128px;
    margin-bottom: 24px;
}

.install-modal-mascot-circle {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: #ffedd5;
    border: 4px solid white;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    overflow: hidden;
}

.install-modal-pet-svg {
    width: 100%;
    height: 100%;
    padding: 12px;
}

.install-modal-badge {
    position: absolute;
    bottom: -4px;
    right: -4px;
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.install-modal-badge .material-symbols-outlined {
    font-size: 20px;
    color: var(--color-primary-orange);
    font-variation-settings: 'FILL' 1;
}

.install-modal-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 8px 0;
    line-height: 1.2;
    letter-spacing: -0.02em;
}

.install-modal-desc {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin: 0 0 32px 0;
    line-height: 1.5;
    font-weight: 500;
}

.install-modal-buttons {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.install-modal-btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 14px 24px;
    background: var(--color-primary-orange);
    color: var(--color-text-primary);
    border: none;
    border-radius: 16px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.25);
}

.install-modal-btn-primary:hover {
    background: #ff8035;
}

.install-modal-btn-primary:active {
    transform: scale(0.98);
}

.install-modal-btn-primary .material-symbols-outlined {
    font-size: 20px;
    transition: transform 0.2s;
}

.install-modal-btn-primary:hover .material-symbols-outlined {
    transform: translateX(4px);
}

.install-modal-btn-secondary {
    width: 100%;
    padding: 12px;
    background: transparent;
    border: none;
    color: var(--color-text-muted);
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 16px;
    transition: all 0.2s;
}

.install-modal-btn-secondary:hover {
    background: rgba(0, 0, 0, 0.05);
}

/* iOS Instructions */
.install-modal-ios-hint {
    width: 100%;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.06);
    text-align: left;
}

.install-modal-ios-hint.hidden {
    display: none;
}

.install-modal-ios-title {
    display: block;
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: 12px;
}

.install-modal-ios-step {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    background: var(--color-bg-primary);
    padding: 16px;
    border-radius: 16px;
    border: 1px solid rgba(0, 0, 0, 0.05);
    margin-bottom: 12px;
}

.install-modal-ios-step:last-child {
    margin-bottom: 0;
}

.install-modal-ios-num {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-top: 4px;
}

.install-modal-ios-icon {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(59, 130, 246, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.install-modal-ios-icon .material-symbols-outlined {
    font-size: 18px;
    color: #3b82f6;
}

.install-modal-ios-text {
    flex: 1;
    font-size: 0.75rem;
    color: var(--color-text-muted);
    line-height: 1.5;
}

.install-modal-ios-text strong {
    color: var(--color-text-primary);
    font-weight: 700;
}

/* High Contrast - Install Modal */
.high-contrast .install-modal-card {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .install-modal-gradient {
    background: rgba(255, 144, 69, 0.05);
}

.high-contrast .install-modal-mascot-circle {
    background: #0a0a0a;
    border-color: #333;
}

.high-contrast .install-modal-badge {
    background: #1a1a1a;
    border-color: #333;
}

.high-contrast .install-modal-title {
    color: #fff;
}

.high-contrast .install-modal-desc {
    color: rgba(255, 255, 255, 0.7);
}

.high-contrast .install-modal-btn-secondary:hover {
    background: rgba(255, 255, 255, 0.05);
}

.high-contrast .install-modal-ios-step {
    background: #0a0a0a;
    border-color: #333;
}

.high-contrast .install-modal-ios-text {
    color: rgba(255, 255, 255, 0.7);
}

/* ================================
   GAMES HEADER STYLES
   ================================ */

.games-header {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    padding-top: max(16px, env(safe-area-inset-top));
}

.games-back-btn {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: all 0.2s;
}

.games-back-btn:hover {
    background: #f9fafb;
    transform: scale(1.05);
}

.games-back-btn .material-symbols-outlined {
    font-size: 24px;
    color: var(--color-text-primary);
}

.games-header-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0;
}

.games-header-spacer {
    width: 44px;
}

/* ================================
   GAME PLAY SCREEN STYLES
   ================================ */

.game-play-screen {
    display: none;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
    background: var(--color-bg-primary);
    position: relative;
}

.game-play-screen.active {
    display: flex;
}

.game-play-bg-pattern {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(#ff9045 15%, transparent 15%),
        radial-gradient(#ff9045 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.03;
    pointer-events: none;
    z-index: 0;
}

.game-play-glow {
    position: absolute;
    top: -60px;
    right: -60px;
    width: 200px;
    height: 200px;
    background: rgba(255, 144, 69, 0.15);
    border-radius: 50%;
    filter: blur(48px);
    pointer-events: none;
    z-index: 0;
}

.game-play-header {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    padding-top: max(16px, env(safe-area-inset-top));
}

.game-play-back-btn {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.05);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s;
}

.game-play-back-btn:hover {
    background: rgba(0, 0, 0, 0.1);
}

.game-play-back-btn .material-symbols-outlined {
    font-size: 24px;
    color: var(--color-text-primary);
}

.game-play-stats {
    display: flex;
    align-items: center;
    gap: 16px;
}

.game-stat {
    display: flex;
    align-items: center;
    gap: 4px;
    background: white;
    padding: 8px 12px;
    border-radius: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    font-weight: 700;
    font-size: 0.875rem;
}

.game-stat .material-symbols-outlined {
    font-size: 18px;
    color: #fbbf24;
}

.game-stat-lives {
    background: transparent;
    box-shadow: none;
    padding: 0;
}

.game-play-progress {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-muted);
    background: white;
    padding: 8px 16px;
    border-radius: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.game-play-content {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
    gap: 32px;
}

.game-play-question {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    text-align: center;
    margin: 0;
}

.game-braille-display {
    display: flex;
    justify-content: center;
    padding: 24px;
}

.game-braille-cell {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    padding: 24px;
    background: white;
    border-radius: 24px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.game-braille-dot {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: #e5e7eb;
    border: none;
    transition: all 0.2s ease;
    cursor: default;
}

.game-braille-dot.active {
    background: var(--color-primary-orange);
    box-shadow: 0 4px 12px rgba(255, 144, 69, 0.4);
}

.game-answer-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    width: 100%;
    max-width: 320px;
}

.game-answer-btn {
    padding: 20px;
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 16px;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.game-answer-btn:hover:not(:disabled) {
    border-color: var(--color-primary-orange);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.game-answer-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.game-answer-btn.correct {
    background: #10b981;
    border-color: #10b981;
    color: white;
    animation: pulse 0.3s ease;
}

.game-answer-btn.incorrect {
    background: #ef4444;
    border-color: #ef4444;
    color: white;
    animation: shake 0.3s ease;
}

@keyframes pulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

@keyframes shake {

    0%,
    100% {
        transform: translateX(0);
    }

    25% {
        transform: translateX(-5px);
    }

    75% {
        transform: translateX(5px);
    }
}

.game-feedback {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px 24px;
    border-radius: 16px;
    animation: fadeIn 0.3s ease;
}

.game-feedback.hidden {
    display: none;
}

.game-feedback.correct {
    background: rgba(16, 185, 129, 0.1);
}

.game-feedback.incorrect {
    background: rgba(239, 68, 68, 0.1);
}

.game-feedback-icon {
    font-size: 2rem;
}

.game-feedback-text {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
}

.game-feedback.correct .game-feedback-text {
    color: #10b981;
}

.game-feedback.incorrect .game-feedback-text {
    color: #ef4444;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.game-play-footer {
    position: relative;
    z-index: 10;
    padding: 20px 24px;
    padding-bottom: max(20px, env(safe-area-inset-bottom));
}

.game-play-footer.hidden {
    display: none;
}

.game-play-next-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 16px;
    background: var(--color-primary-orange);
    color: var(--color-text-primary);
    border: none;
    border-radius: 16px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 16px rgba(255, 144, 69, 0.3);
}

.game-play-next-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.4);
}

/* ================================
   GAME OVER SCREEN STYLES
   ================================ */

.game-over-screen {
    display: none;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
    background: var(--color-bg-primary);
    position: relative;
}

.game-over-screen.active {
    display: flex;
}

.game-over-bg-pattern {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(#ff9045 15%, transparent 15%),
        radial-gradient(#ff9045 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.03;
    pointer-events: none;
    z-index: 0;
}

.game-over-content {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 32px 24px;
    text-align: center;
}

.game-over-icon {
    font-size: 4rem;
    margin-bottom: 16px;
    animation: bounceIn 0.5s ease;
}

@keyframes bounceIn {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.game-over-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0 0 8px 0;
}

.game-over-subtitle {
    font-size: 1rem;
    color: var(--color-text-muted);
    margin: 0 0 32px 0;
}

.game-over-stats {
    display: flex;
    justify-content: center;
    gap: 24px;
    margin-bottom: 24px;
}

.game-over-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    background: white;
    padding: 16px 24px;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.game-over-stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
}

.game-over-stat-label {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.game-over-xp {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 144, 69, 0.1);
    padding: 12px 24px;
    border-radius: 20px;
    margin-bottom: 32px;
}

.game-over-xp .material-symbols-outlined {
    font-size: 24px;
    color: var(--color-primary-orange);
}

.game-over-xp span:last-child {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--color-primary-orange);
}

.game-over-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 100%;
    max-width: 320px;
}

.game-over-btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 16px;
    background: var(--color-primary-orange);
    color: var(--color-text-primary);
    border: none;
    border-radius: 16px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 16px rgba(255, 144, 69, 0.3);
}

.game-over-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(255, 144, 69, 0.4);
}

.game-over-btn-secondary {
    width: 100%;
    padding: 14px;
    background: transparent;
    color: var(--color-text-muted);
    border: none;
    border-radius: 16px;
    font-size: 0.9375rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.game-over-btn-secondary:hover {
    background: rgba(0, 0, 0, 0.05);
    color: var(--color-text-primary);
}

/* ================================
   FORMA LA PALABRA GAME STYLES
   ================================ */

.game-play-bg-blue {
    background-image:
        radial-gradient(#3b82f6 15%, transparent 15%),
        radial-gradient(#3b82f6 15%, transparent 15%);
}

.game-play-glow-blue {
    background: rgba(59, 130, 246, 0.15);
}

.game-play-btn-blue {
    background: #3b82f6;
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
}

.game-play-btn-blue:hover {
    background: #2563eb;
}

.game-play-btn-purple {
    background: #8b5cf6;
    box-shadow: 0 4px 16px rgba(139, 92, 246, 0.3);
}

.game-play-btn-purple:hover {
    background: #7c3aed;
}

.game-play-btn-blue,
.game-play-btn-purple {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 14px 20px;
    color: white;
    border: none;
    border-radius: 14px;
    font-size: 0.9375rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
}

.form-word-target {
    font-size: 2.5rem;
    font-weight: 800;
    letter-spacing: 0.1em;
    color: var(--color-text-primary);
    background: white;
    padding: 16px 32px;
    border-radius: 20px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    margin-bottom: 24px;
}

.form-word-slots {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 32px;
    flex-wrap: wrap;
}

.form-word-slot {
    width: 70px;
    height: 90px;
    background: white;
    border: 3px dashed #e5e7eb;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: all 0.2s;
}

.form-word-slot.filled {
    border-style: solid;
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.05);
}

.form-word-slot.correct {
    border-color: #10b981;
    background: rgba(16, 185, 129, 0.1);
}

.form-word-slot.incorrect {
    border-color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
}

.form-word-slot-letter {
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    background: #3b82f6;
    color: white;
    font-size: 0.75rem;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 8px;
}

.form-word-options {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
    max-width: 400px;
}

.form-word-option {
    width: 70px;
    height: 90px;
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.form-word-option:hover:not(.used) {
    border-color: #3b82f6;
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.form-word-option.selected {
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.1);
}

.form-word-option.used {
    opacity: 0.3;
    cursor: not-allowed;
}

.form-word-option-cell {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 4px;
    margin-bottom: 6px;
}

.form-word-option-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #e5e7eb;
}

.form-word-option-dot.active {
    background: #3b82f6;
}

.form-word-option-label {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--color-text-primary);
}

.game-check-btn {
    background: #3b82f6;
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
}

.game-check-btn:hover:not(:disabled) {
    background: #2563eb;
}

.game-check-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* ================================
   MEMORIA BRAILLE GAME STYLES
   ================================ */

.game-play-bg-purple {
    background-image:
        radial-gradient(#8b5cf6 15%, transparent 15%),
        radial-gradient(#8b5cf6 15%, transparent 15%);
}

.game-play-glow-purple {
    background: rgba(139, 92, 246, 0.15);
}

.game-play-timer {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-text-muted);
    background: white;
    padding: 8px 16px;
    border-radius: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.game-play-timer .material-symbols-outlined {
    font-size: 18px;
    color: #8b5cf6;
}

.memory-content {
    padding-top: 16px;
}

.memory-instruction {
    font-size: 1.25rem;
    margin-bottom: 24px;
}

.memory-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    width: 100%;
    max-width: 320px;
}

.memory-card {
    aspect-ratio: 1;
    perspective: 1000px;
    cursor: pointer;
}

.memory-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.5s;
    transform-style: preserve-3d;
}

.memory-card.flipped .memory-card-inner {
    transform: rotateY(180deg);
}

.memory-card.matched .memory-card-inner {
    transform: rotateY(180deg);
}

.memory-card-front,
.memory-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.memory-card-front {
    background: linear-gradient(135deg, #8b5cf6, #6366f1);
    color: white;
}

.memory-card-front .material-symbols-outlined {
    font-size: 24px;
}

.memory-card-back {
    background: white;
    transform: rotateY(180deg);
    border: 2px solid #e5e7eb;
}

.memory-card.matched .memory-card-back {
    border-color: #10b981;
    background: rgba(16, 185, 129, 0.1);
}

.memory-card-back.letter {
    font-size: 1.5rem;
    font-weight: 800;
    color: var(--color-text-primary);
}

.memory-card-back.braille {
    padding: 8px;
}

.memory-braille-cell {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 4px;
}

.memory-braille-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #e5e7eb;
}

.memory-braille-dot.active {
    background: #8b5cf6;
}

.memory-card:hover:not(.flipped):not(.matched) .memory-card-front {
    box-shadow: 0 8px 24px rgba(139, 92, 246, 0.3);
}

@keyframes matchPulse {

    0%,
    100% {
        transform: rotateY(180deg) scale(1);
    }

    50% {
        transform: rotateY(180deg) scale(1.05);
    }
}

.memory-card.matched .memory-card-inner {
    animation: matchPulse 0.5s ease;
}

/* ================================
   Native Ad Styles
   ================================ */

.ad-container {
    width: 100%;
    margin: var(--space-md) 0;
    overflow: hidden;
    border-radius: var(--radius-md);
    background: transparent;
    display: flex;
    justify-content: center;
    position: relative;
    z-index: 5;
}

.native-ad-banner {
    width: 100%;
    /* max-width: 320px; Standard mobile ad width */
    min-height: 100px;
    background: #f0f0f0;
    border: 1px dashed #cbd5e1;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

/* Simulate Ad Content */
.native-ad-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 12px;
    width: 100%;
}

.ad-badge {
    position: absolute;
    top: 4px;
    right: 4px;
    background: rgba(0, 0, 0, 0.1);
    color: #666;
    font-size: 0.6rem;
    padding: 2px 4px;
    border-radius: 4px;
    text-transform: uppercase;
}

.ad-placeholder-img {
    width: 48px;
    height: 48px;
    background: #ddd;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #999;
}

.ad-text {
    text-align: center;
}

.ad-title {
    font-weight: 700;
    font-size: 0.9rem;
    color: var(--color-text-primary);
}

.ad-desc {
    font-size: 0.75rem;
    color: var(--color-text-secondary);
}

.ad-cta {
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-accent-primary);
    margin-top: 4px;
}

/* Pre-Lesson Specific Ad Style */
.pre-lesson-sheet .ad-container {
    margin-top: auto;
    /* Push to bottom if flex layout allows */
    margin-bottom: var(--space-md);
}

/* Game List Native Ad Card */
.game-card.sponsored {
    position: relative;
    border: 2px solid #e2e8f0;
}

.game-card.sponsored .game-icon {
    background: #f1f5f9;
    color: #94a3b8;
}

.game-card.sponsored .game-play-btn {
    background: #f1f5f9;
    color: #64748b;
}

.game-card.sponsored::after {
    content: 'Patrocinado';
    position: absolute;
    top: 12px;
    right: 12px;
    font-size: 0.65rem;
    color: #94a3b8;
    background: #f8fafc;
    padding: 2px 6px;
    border-radius: 4px;
    border: 1px solid #e2e8f0;
}

/* ================================
   Pick Screen - New Design
   ================================ */

.pick-screen-new {
    /* Inherits display: none/flex from .screen class */
    /* Inherits flex-direction: column from .screen class */
    min-height: 100vh;
    min-height: 100dvh;
    background: var(--color-bg-primary);
    position: relative;
    overflow: hidden;
}

.pick-bg-pattern {
    position: absolute;
    inset: 0;
    background-image: radial-gradient(#ff9045 15%, transparent 15%), radial-gradient(#ff9045 15%, transparent 15%);
    background-position: 0 0, 15px 15px;
    background-size: 30px 30px;
    opacity: 0.03;
    pointer-events: none;
    z-index: 0;
}

.pick-bg-glow {
    position: absolute;
    top: -80px;
    right: -80px;
    width: 256px;
    height: 256px;
    background: rgba(255, 144, 69, 0.1);
    border-radius: 50%;
    filter: blur(48px);
    pointer-events: none;
    z-index: 0;
}

/* Pick Header */
.pick-header {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-lg) var(--space-lg);
    padding-top: max(var(--space-lg), env(safe-area-inset-top));
}

.pick-close-btn {
    color: var(--color-text-muted);
    background: none;
    border: none;
    padding: var(--space-xs);
    margin-left: calc(-1 * var(--space-xs));
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.pick-close-btn:hover {
    background: rgba(0, 0, 0, 0.05);
}

.pick-close-btn .material-symbols-outlined {
    font-size: 28px;
    font-weight: 600;
}

.pick-progress-bar-container {
    flex: 1;
    height: 16px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: var(--radius-full);
    overflow: hidden;
    position: relative;
}

.pick-progress-bar-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: #0e1b13;
    border-radius: var(--radius-full);
    transition: width 0.5s ease-out;
}

.pick-progress-shine {
    position: absolute;
    top: 4px;
    right: 8px;
    width: 16px;
    height: 6px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: var(--radius-full);
}

.pick-lives {
    display: flex;
    align-items: center;
    gap: 6px;
}

.pick-heart-icon {
    color: #EF4444;
    font-variation-settings: 'FILL' 1;
}

.pick-lives-count {
    color: #EF4444;
    font-weight: 700;
    font-size: var(--font-size-lg);
}

/* Pick Main Content */
.pick-main-content {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0 var(--space-lg);
    gap: var(--space-lg);
}

/* Question Area with Speech Bubble and Mascot */
.pick-question-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
    width: 100%;
}

.pick-speech-bubble {
    position: relative;
    background: #FFFFFF;
    border-radius: 24px;
    padding: var(--space-md) var(--space-lg);
    color: var(--color-text-primary);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    text-align: center;
    font-weight: 600;
    font-size: var(--font-size-xl);
    max-width: 320px;
}

.pick-speech-bubble::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 0;
    border: 15px solid transparent;
    border-top-color: #FFFFFF;
    border-bottom: 0;
    margin-left: -15px;
    margin-bottom: -15px;
}

.pick-question-text {
    color: var(--color-text-primary);
}

.pick-target-letter {
    color: var(--color-accent-primary);
    font-weight: 800;
    font-size: var(--font-size-2xl);
}

/* Mascot */
.pick-mascot {
    width: 96px;
    height: 96px;
    flex-shrink: 0;
    position: relative;
}

.pick-pet-svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
}

.pick-mascot-pointer {
    position: absolute;
    bottom: -8px;
    right: -8px;
    font-size: 32px;
    color: #ff9045;
    font-variation-settings: 'FILL' 1;
    font-weight: 600;
}



/* Pick Footer */
.pick-screen-new .pick-footer {
    position: relative;
    z-index: 10;
    padding: var(--space-lg);
    padding-bottom: max(var(--space-lg), env(safe-area-inset-bottom));
    background: #FFFFFF;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    display: none;
    /* Hidden by default if screen not active */
}

/* Show footer only when screen is active */
.pick-screen-new.active .pick-footer {
    display: block;
}

.pick-check-button {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 16px;
    height: 56px;
    background: #ff9045;
    color: #0e1b13;
    font-size: var(--font-size-lg);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border: none;
    cursor: pointer;
    box-shadow: 0 6px 0 rgba(255, 144, 69, 0.4);
    transition: all var(--transition-fast);
}

.pick-check-button:hover {
    background: #ff8533;
}

.pick-check-button:active {
    transform: translateY(3px);
    box-shadow: 0 3px 0 rgba(255, 144, 69, 0.4);
}

.pick-check-button:disabled {
    background: #E5E7EB;
    color: #9CA3AF;
    box-shadow: 0 6px 0 #D1D5DB;
    cursor: not-allowed;
}

/* ================================
   Repaso 2.0 Styles (Ported from Tailwind)
   ================================ */

/* Scoped variables for this screen to match repaso2.html exactly */
.pick-screen-new {
    --pick-bg-light: #f6f8f7;
    --pick-bg-dark: #112117;
    --pick-surface-light: #ffffff;
    --pick-surface-dark: #1c3024;
    --pick-primary: #ff9045;
    background-color: var(--pick-bg-light);
    color: #0e1b13;
    font-family: 'Lexend', "Noto Sans", sans-serif;
}

.dark .pick-screen-new {
    background-color: var(--pick-bg-dark);
    color: #f6f8f7;
}

/* Header */
.pick-v2-header {
    position: relative;
    z-index: 10;
    width: 100%;
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 24px 24px 0 24px;
    /* pt-8 pb-0 to match spacing */
    max-width: 448px;
    /* max-w-md */
    margin: 0 auto;
}

.pick-v2-close-btn {
    color: rgba(14, 27, 19, 0.4);
    padding: 8px;
    margin-left: -8px;
    border-radius: 9999px;
    transition: background-color 0.2s;
    background: transparent;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.pick-v2-close-btn:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

.dark .pick-v2-close-btn {
    color: rgba(255, 255, 255, 0.4);
}

.dark .pick-v2-close-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* Progress Bar */
.pick-v2-progress-container {
    flex: 1;
    height: 16px;
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 9999px;
    overflow: hidden;
    position: relative;
}

.dark .pick-v2-progress-container {
    background-color: rgba(255, 255, 255, 0.1);
}

.pick-v2-progress-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background-color: var(--pick-primary);
    border-radius: 9999px;
    width: 0%;
    /* Dynamic */
    transition: width 0.5s ease-out;
}

.pick-v2-progress-shine {
    position: absolute;
    top: 4px;
    right: 8px;
    width: 16px;
    height: 6px;
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 9999px;
}

/* Lives */
.pick-v2-lives {
    display: flex;
    align-items: center;
    gap: 6px;
}

.pick-v2-lives .material-symbols-outlined {
    color: #ef4444;
    /* text-red-500 */
    font-variation-settings: 'FILL' 1;
}

.pick-v2-lives-count {
    color: #ef4444;
    font-weight: 700;
    font-size: 1.125rem;
    /* text-lg */
}

/* Main Content */
.pick-v2-main {
    position: relative;
    z-index: 10;
    flex: 1;
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 448px;
    margin: 0 auto;
    padding: 16px;
}

.pick-v2-title {
    font-size: 1.5rem;
    /* text-2xl */
    font-weight: 700;
    margin-bottom: 32px;
    color: inherit;
}

.pick-v2-content-wrapper {
    display: flex;
    flex-direction: column;
    gap: 24px;
    flex: 1;
    justify-content: center;
}

/* Mascot + Bubble Area */
.pick-v2-mascot-area {
    display: flex;
    align-items: flex-end;
    gap: 12px;
    align-self: flex-start;
    width: 100%;
    margin-bottom: 12px;
}

.pick-v2-mascot {
    width: 72px;
    height: 72px;
    flex-shrink: 0;
    position: relative;
    z-index: 10;
}

@media (min-width: 640px) {
    .pick-v2-mascot {
        width: 112px;
        height: 112px;
    }
}

.pick-v2-mascot svg {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 10px 8px rgba(0, 0, 0, 0.04)) drop-shadow(0 4px 3px rgba(0, 0, 0, 0.1));
}

.pick-v2-speech-bubble {
    position: relative;
    background-color: var(--pick-surface-light);
    border: 2px solid #e5e7eb;
    padding: 16px;
    border-radius: 16px;
    border-bottom-left-radius: 0;
    margin-bottom: 12px;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    flex: 1;
}

.dark .pick-v2-speech-bubble {
    background-color: var(--pick-surface-dark);
    border-color: #374151;
}

.pick-v2-bubble-tail-border {
    position: absolute;
    left: -9px;
    bottom: 0;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-bottom: 15px solid #e5e7eb;
}

.dark .pick-v2-bubble-tail-border {
    border-bottom-color: #374151;
}

.pick-v2-bubble-tail-fill {
    position: absolute;
    left: -6px;
    bottom: 2px;
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-bottom: 12px solid var(--pick-surface-light);
}

.dark .pick-v2-bubble-tail-fill {
    border-bottom-color: var(--pick-surface-dark);
}

.pick-v2-question-text {
    font-weight: 500;
    font-size: 1.125rem;
    /* text-lg */
    color: inherit;
    margin: 0;
}

/* Options Grid */
.pick-v2-options-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    width: 100%;
}

.pick-v2-option-btn {
    position: relative;
    width: 100%;
    /* Removed aspect-ratio: 1 to allow shorter height */
    padding: 12px;
    border-radius: 16px;
    border: 2px solid #e5e7eb;
    background-color: var(--pick-surface-light);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s;
    cursor: pointer;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}

.dark .pick-v2-option-btn {
    background-color: var(--pick-surface-dark);
    border-color: #374151;
}

.pick-v2-option-btn:hover {
    background-color: #f9fafb;
}

.dark .pick-v2-option-btn:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

/* Selected Styling */
.pick-v2-option-btn.selected {
    border-color: var(--pick-primary);
    background-color: rgba(255, 144, 69, 0.05);
    /* bg-primary/5 */
    box-shadow: 0 0 0 2px rgba(255, 144, 69, 0.2);
}

.dark .pick-v2-option-btn.selected {
    background-color: rgba(255, 144, 69, 0.1);
}

/* Correct Styling */
/* Correct Styling - Fixed Animations */
.pick-v2-option-btn.correct {
    border-color: #22c55e;
    /* green-500 */
    background-color: rgba(34, 197, 94, 0.05);
    box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
}

.pick-v2-option-btn.correct .pick-v2-number-badge {
    background-color: #22c55e;
    border-color: #22c55e;
    color: white;
}

.pick-v2-option-btn.correct .pick-v2-check-mark {
    color: #22c55e;
    display: block;
}

/* Incorrect Styling */
.pick-v2-option-btn.incorrect {
    border-color: #ef4444;
    /* red-500 */
    background-color: rgba(239, 68, 68, 0.05);
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);
}

.pick-v2-option-btn.incorrect .pick-v2-number-badge {
    background-color: #ef4444;
    border-color: #ef4444;
    color: white;
}

.pick-v2-option-btn.incorrect .pick-v2-check-mark {
    display: none;
}

/* Number Badge */
/* Number Badge */
.pick-v2-number-badge {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid #f3f4f6;
    /* gray-100 */
    border-radius: 50%;
    color: #9ca3af;
    /* gray-400 */
    font-weight: 700;
    font-size: 1rem;
    transition: all 0.2s;
}

.dark .pick-v2-number-badge {
    border-color: #4b5563;
    /* gray-600 */
    color: #6b7280;
    /* gray-500 */
}

/* Badge interaction */
.pick-v2-option-btn:hover .pick-v2-number-badge {
    border-color: #d1d5db;
    /* gray-300 */
}

.pick-v2-option-btn.selected .pick-v2-number-badge {
    background-color: var(--pick-primary);
    border-color: var(--pick-primary);
    color: #0e1b13;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
}

/* Check Mark for Selected */
.pick-v2-check-mark {
    position: absolute;
    top: 8px;
    right: 8px;
    padding: 8px;
    color: var(--pick-primary);
    display: none;
}

.pick-v2-option-btn.selected .pick-v2-check-mark {
    display: block;
}

/* Braille Grid */
.pick-v2-braille-grid {
    display: grid;
    grid-template-columns: repeat(2, auto);
    column-gap: 14px;
    row-gap: 10px;
    pointer-events: none;
}

.pick-v2-dot {
    width: 28px;
    height: 28px;
    border-radius: 9999px;
    background-color: #e5e7eb;
    /* gray-200 */
}

.dark .pick-v2-dot {
    background-color: #374151;
    /* gray-700 */
}

.pick-v2-dot.filled {
    background-color: #0e1b13;
}

.dark .pick-v2-dot.filled {
    background-color: #ffffff;
}

/* Footer & Button */
.pick-v2-footer {
    position: relative;
    z-index: 10;
    width: 100%;
    width: 100%;
    padding: 16px;
    border-top: 1px solid rgba(14, 27, 19, 0.05);
    background-color: var(--pick-surface-light);
    max-width: 448px;
    margin: 0 auto;
}

/* ================================
   New Build Game Screen Styles
   ================================ */


.braille-dot {
    width: 5rem;
    height: 5rem;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 600;
    color: #64748B;
    /* Light gray for visible numbers */
    background-color: #D1D5DB;
    /* Lighter gray to match reference */
    border: none;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    user-select: none;
    cursor: pointer;
}

.braille-dot:active {
    transform: scale(0.95);
}

.braille-dot.active,
.braille-dot[aria-checked="true"] {
    background-color: #ff9045 !important;
    /* Orange accent */
    color: white;
    box-shadow: 0 4px 12px rgba(255, 144, 69, 0.4);
    transform: translateY(-2px);
}

.bg-orange-accent {
    background-color: #ff9045;
}

.text-orange-accent {
    color: #ff9045;
}

/* Build Screen Specific Layouts */
.build-mascot-bubble-row {
    display: flex;
    align-items: flex-start;
    justify-content: flex-start;
    gap: 12px;
    width: 100%;
    margin-bottom: 24px;
    padding: 0 8px;
}

.build-mascot {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
}

.build-speech-bubble {
    flex: 1;
    background-color: white;
    padding: 16px 20px;
    border-radius: 16px;
    border-top-left-radius: 4px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid #f1f5f9;
}

.build-speech-text {
    color: #334155;
    font-weight: 500;
    font-size: 16px;
    line-height: 1.4;
}

.build-card {
    background-color: white;
    border-radius: 32px;
    padding: 40px;
    box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.1);
    width: 100%;
    max-width: 280px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.build-dots-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 32px;
    width: 100%;
}

.build-main-cell {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}


.shadow-card {
    box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.08);
}

.shadow-soft {
    box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.05);
}

.dark .pick-v2-footer {
    border-color: rgba(255, 255, 255, 0.05);
    background-color: #15281d;
}

.pick-v2-check-btn {
    width: 100%;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 16px;
    background-color: var(--pick-primary);
    color: #0e1b13;
    font-size: 1.125rem;
    font-weight: 700;
    letter-spacing: 0.025em;
    text-transform: uppercase;
    box-shadow: 0 10px 15px -3px rgba(255, 144, 69, 0.25);
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}

.pick-v2-check-btn:hover {
    background-color: rgba(255, 144, 69, 0.9);
}

.pick-v2-check-btn:active {
    transform: scale(0.98);
}

.pick-v2-check-btn:disabled {
    background-color: #e5e7eb;
    color: #9ca3af;
    box-shadow: none;
    cursor: not-allowed;
}